(this["webpackJsonpopencast-react-studio"]=this["webpackJsonpopencast-react-studio"]||[]).push([[4],{130:function(e,t,a){"use strict";a.r(t);var n=a(10),r=a(69),o=a(1),i=a.n(o),c=a(106),s=a(100),l=a(108),d=a(52),u=a(35),b=a(17);const p="microphone",g="none",O="both",h="display",m="user",j="none",v="not_uploaded",x="uploading",f="uploaded",y="error",w=()=>({mediaDevices:[],audioAllowed:null,audioStream:null,audioUnexpectedEnd:!1,audioSupported:Object(b.f)(),displayAllowed:null,displayStream:null,displayUnexpectedEnd:!1,displaySupported:Object(b.d)(),userAllowed:null,userStream:null,userUnexpectedEnd:!1,userSupported:Object(b.f)(),videoChoice:j,audioChoice:g,isRecording:!1,prematureRecordingEnd:!1,recordings:[],title:"",presenter:"",start:null,end:null,upload:{error:null,state:v,secondsLeft:null,currentProgress:0}}),k=(e,t)=>{switch(t.type){case"UPDATE_MEDIA_DEVICES":return{...e,mediaDevices:t.payload};case"CHOOSE_AUDIO":return{...e,audioChoice:t.payload};case"CHOOSE_VIDEO":return{...e,videoChoice:t.payload};case"SHARE_AUDIO":return{...e,audioStream:t.payload,audioAllowed:!0,audioUnexpectedEnd:!1};case"BLOCK_AUDIO":return{...e,audioStream:null,audioAllowed:!1,audioUnexpectedEnd:!1};case"UNSHARE_AUDIO":return{...e,audioStream:null,audioUnexpectedEnd:!1};case"AUDIO_UNEXPETED_END":return{...e,audioStream:null,audioUnexpectedEnd:!0};case"SHARE_DISPLAY":return{...e,displayStream:t.payload,displayAllowed:!0,displayUnexpectedEnd:!1};case"BLOCK_DISPLAY":return{...e,displayStream:null,displayAllowed:!1,displayUnexpectedEnd:!1};case"UNSHARE_DISPLAY":return{...e,displayStream:null,displayUnexpectedEnd:!1};case"DISPLAY_UNEXPETED_END":return{...e,displayStream:null,displayUnexpectedEnd:!0};case"SHARE_USER":return{...e,userStream:t.payload,userAllowed:!0,userUnexpectedEnd:!1};case"BLOCK_USER":return{...e,userStream:null,userAllowed:!1,userUnexpectedEnd:!1};case"UNSHARE_USER":return{...e,userStream:null,userUnexpectedEnd:!1};case"USER_UNEXPETED_END":return{...e,userStream:null,userUnexpectedEnd:!0};case"START_RECORDING":return{...e,isRecording:!0};case"STOP_RECORDING":return{...e,isRecording:!1};case"STOP_RECORDING_PREMATURELY":return{...e,isRecording:!1,prematureRecordingEnd:!0};case"CLEAR_RECORDINGS":return{...e,recordings:[],prematureRecordingEnd:!1};case"ADD_RECORDING":const a=[...e.recordings.filter((e=>e.deviceType!==t.payload.deviceType)),t.payload];return{...e,recordings:a};case"UPLOAD_ERROR":return{...e,upload:{...e.upload,error:t.payload,state:y}};case"UPLOAD_REQUEST":return{...e,upload:{...e.upload,error:null,state:x}};case"UPLOAD_SUCCESS":return{...e,upload:{...e.upload,error:null,state:f}};case"UPLOAD_PROGRESS_UPDATE":return{...e,upload:{...e.upload,secondsLeft:t.payload.secondsLeft,currentProgress:t.payload.currentProgress}};case"MARK_DOWNLOADED":const n=e.recordings.map(((e,a)=>a===t.payload?{...e,downloaded:!0}:e));return{...e,recordings:n};case"UPDATE_TITLE":return{...e,title:t.payload};case"UPDATE_PRESENTER":return{...e,presenter:t.payload};case"UPDATE_START":return{...e,start:t.payload};case"UPDATE_END":return{...e,end:t.payload};case"RESET":return w();default:throw new Error}},S=Object(o.createContext)(null),E=Object(o.createContext)(null),R=({children:e})=>{const[t,a]=Object(o.useReducer)(k,w());return Object(n.a)(E.Provider,{value:a},Object(n.a)(S.Provider,{value:t},e))},C=()=>Object(o.useContext)(E),D=(e=null)=>{const t=Object(o.useContext)(S);return null!==e?t[e]:t};var A=a(29),T=a(102),I=a(101);function _(){return Object(n.a)("article",null,Object(n.a)(A.b.h2,null,"ELAN e.V."),Object(n.a)(A.b.p,null,"The e-learning academic network (ELAN e.V.) is a German non-profit organization supporting higher-education organizations in all matters related to e-learning. Our services include practical tips about how to use digital technologies in education, legal advice and development of free, open-source software to support education."),Object(n.a)(A.b.h3,null,"Contact"),Object(n.a)(A.b.p,null,"Dr. Norbert Kleinefeld, Gesch\xe4ftsf\xfchrer",Object(n.a)("br",null),"Karlstr. 23",Object(n.a)("br",null),"D-26123 Oldenburg"),Object(n.a)(A.b.p,null,Object(n.a)(T.a,{icon:I.n})," ",Object(n.a)(A.b.a,{href:"https://elan-ev.de"},"elan-ev.de"),Object(n.a)("br",null),Object(n.a)(T.a,{icon:I.k})," ",Object(n.a)(A.b.a,{href:"mailto:kontakt@elan-ev.de"},"kontakt@elan-ev.de"),Object(n.a)("br",null),Object(n.a)(T.a,{icon:I.u})," ",Object(n.a)(A.b.a,{href:"tel:+4944199866610"},"+49\u2009441 998\u2009666\u200910")),Object(n.a)(A.b.p,null,"Registergericht: Amtsgericht Oldenburg",Object(n.a)("br",null),"Registernummer: VR 200644",Object(n.a)("br",null),"USt.-ID-Nr.: DE 265901392"))}var U=function(e){return Object(n.a)(r.d,null,Object(n.a)("article",{sx:{maxWidth:"900px",margin:"0 auto"}},Object(n.a)("header",null,Object(n.a)(A.b.h1,null,"Opencast Studio")),Object(n.a)(A.b.p,null,"A web-based recording studio for ",Object(n.a)(A.b.a,{href:"https://opencast.org"},"Opencast"),"."),Object(n.a)(A.b.p,null,"Opencast Studio allows you to record your camera, your display and your microphone\u02bcs audio. You can then either download your recordings or upload them directly to an Opencast instance (usually the one of your university)."),Object(n.a)(A.b.p,null,"This is free software under the terms of the"," ",Object(n.a)(A.b.a,{href:"https://github.com/elan-ev/opencast-studio/blob/master/LICENSE"},"MIT License")," ","developed by the ",Object(n.a)(A.b.a,{href:"https://elan-ev.de"},"ELAN e.V.")," in cooperation with the ",Object(n.a)(A.b.a,{href:"https://ethz.ch"},"ETH Z\xfcrich"),"."),Object(n.a)(A.b.h2,null,"How it works"),Object(n.a)(A.b.p,null,"Opencast Studio uses the recording capabilities built into modern browsers to record audio and video streams. The recording happens in the user\u02bcs browser and no server is involved in the recording."),Object(n.a)(i.a.Fragment,null,Object(n.a)(A.b.h2,null,"Support"),Object(n.a)(A.b.p,null,"If you are experiencing any difficulties or found any bugs, please take a look at the"," ",Object(n.a)(A.b.a,{href:"https://github.com/elan-ev/opencast-studio/issues"},"issue tracker on GitHub"),". Before filing a new issue, please check if one about your topic already exists. We regularly check incoming issues and do our best to address bugs in a timely manner."),Object(n.a)(A.b.p,null,"If you are interested in additional development or want to support the development of Opencast Studio, please contact"," ",Object(n.a)(A.b.a,{href:"mailto:opencast-support@elan-ev.de"},"opencast-support@elan-ev.de"),".")),Object(n.a)(A.b.h2,null,"Credits"),Object(n.a)(A.b.p,null,"Thanks to the following people and institutions for contributing to this project:"),Object(n.a)("ul",null,Object(n.a)("li",null,Object(n.a)(A.b.a,{href:"https://github.com/slampunk"},"Duncan Smith")," for starting this project"),Object(n.a)("li",null,Object(n.a)(A.b.a,{href:"https://github.com/cilt-uct"},"University of Cape Town (CILT)")," ","for letting Duncan start the project"),Object(n.a)("li",null,Object(n.a)(A.b.a,{href:"https://ethz.ch"},"ETH Z\xfcrich")," for financial support and testing"),Object(n.a)("li",null,Object(n.a)(A.b.a,{href:"https://github.com/elan-ev"},"ELAN e.V.")," for the re-implementation and the ongoing development"),Object(n.a)("li",null,"And many members from the Opencast community who helped along the way.")),Object(n.a)(_,null),Object(n.a)(A.b.h2,null,"Version"),Object(n.a)(A.b.p,null,"Build date ","2023-01-09",", commit"," ",Object(n.a)(A.b.a,{"aria-label":"Git commit on GitHub",href:"https://github.com/elan-ev/opencast-studio/commit/4aea2e4"},"4aea2e4"),".")))},P=a(28),L=a(46);function H(){const{isRecording:e}=D(),[t]=Object(P.b)();return Object(n.a)("header",{sx:{height:e=>e.heights.headerHeight,lineHeight:e=>e.heights.headerHeight,color:"background",display:"flex",justifyContent:"space-between",position:"relative",zIndex:3}},Object(n.a)("div",{sx:{backgroundColor:"dark"===t?"gray.4":"gray.0",position:"absolute",zIndex:-3,height:"100%",width:"100%"}}),e&&Object(n.a)("div",{sx:{backgroundColor:"dark"===t?"gray.4":"gray.0",position:"absolute",zIndex:20,height:"100%",width:"100%",opacity:.75}}),Object(n.a)(M,null),Object(n.a)(z,null))}const M=()=>{const e=Object(s.h)(),{isRecording:t}=D();return Object(n.a)(c.b,{to:{pathname:"/",search:e.search},tabIndex:t?"-1":"0",sx:{":focus-visible":{outline:e=>`5px solid ${e.colors.focus[2]} !important`,outlineOffset:"-5px"}}},Object(n.a)("picture",{sx:{display:"block",height:e=>e.heights.headerHeight}},Object(n.a)("source",{media:"(min-width: 920px)",srcSet:"/opencast-studio.svg"}),Object(n.a)("img",{src:"/opencast-studio-small.svg",alt:"Opencast Studio",sx:{height:e=>e.heights.headerHeight}})))},N=({target:e,children:t,icon:a,...r})=>{const o=Object(s.h)(),{isRecording:i}=D(),[l]=Object(P.b)();return Object(n.a)(c.c,Object.assign({to:{pathname:e,search:o.search},tabIndex:i?"-1":"0",exact:!0,activeStyle:{backgroundColor:"black"},sx:{color:"white",pl:[3,"12px"],pr:[3,"12px"],textDecoration:"none",fontSize:"18px",height:["auto","100%"],borderLeft:["none",e=>`1px solid ${e.colors.gray["dark"===l?1:3]}`],display:["block","inline-block"],width:["100%","auto"],"&:hover":{backgroundColor:"dark"===l?"gray.3":"gray.1"},":focus-visible":{outline:e=>`5px solid ${e.colors.focus[2]} !important`,outlineOffset:"-5px"}}},r),Object(n.a)("div",{sx:{width:"20px",display:"inline-block",textAlign:"right",mr:[3,3,2],"@media screen and (max-width: 742px)":{mr:[0,0,0]},"@media screen and (max-width: 575px)":{mr:[3,3,2]}}},Object(n.a)(T.a,{icon:a})),Object(n.a)("div",{sx:{display:"inline-block","@media screen and (max-width: 742px)":{display:"none"},"@media screen and (max-width: 575px)":{display:"inline-block"}}},t))},z=e=>{const[t,a]=Object(o.useState)(!1),r=()=>a(!1),{t:i}=Object(L.c)(),[c]=Object(P.b)();return Object(n.a)(o.Fragment,null,Object(n.a)("button",{onClick:()=>a(!t),title:i("nav-open-menu-button"),sx:{display:["inline-block","none"],border:e=>`2px solid ${e.colors.gray[3]}`,borderRadius:"10px",color:"white",my:1,px:3,mx:1,fontSize:"20px",whiteSpace:"nowrap",backgroundColor:"transparent","&:hover":{backgroundColor:"gray.1"},"&:active":{}}},i("nav-open-menu-button"),Object(n.a)("span",{sx:{width:"23px",display:"inline-block"}},Object(n.a)(T.a,{icon:t?I.z:I.a,sx:{ml:"10px"}}))),Object(n.a)("nav",{ref:e=>{e&&(e.style.height=t?e.scrollHeight+"px":"")},sx:{overflow:"hidden",zIndex:10,height:["0px","100% !important"],top:[e=>e.heights.headerHeight,e=>e.heights.headerHeight,0],position:["absolute","static"],width:["100%","auto"],backgroundColor:["dark"===c?"gray.4":"gray.0","none"],transition:["height 0.25s ease-out 0s","none"],scrollX:["none","auto"]}},Object(n.a)(N,{target:"/",icon:I.E,onClick:r},i("nav-recording")),Object(n.a)(N,{target:"/settings",icon:I.F,onClick:r},i("nav-settings")),Object(n.a)(N,{target:"/shortcuts",icon:I.p,onClick:r},i("nav-shortcuts")),Object(n.a)(N,{target:"/about",icon:I.o,onClick:r},i("nav-about"))),t&&Object(n.a)("div",{onClick:r,ref:e=>e&&(e.style.opacity=1),sx:{display:[t?"block":"none","none"],backgroundColor:"rgba(0, 0, 0, 0.7)",position:"fixed",zIndex:-10,top:0,bottom:0,left:0,right:0,opacity:0,transition:"opacity 0.25s ease-out 0s"}}))};function F({activeStep:e,updateActiveStep:t,...a}){var r;const o={currentStep:e+1,totalSteps:(null===(r=a.children)||void 0===r?void 0:r.length)||0,nextStep:function(){l(e+1)},previousStep:function(){l(e-1)},goToStep:s,firstStep:function(){s(1)},lastStep:function(){s(a.children.length)}},c=i.a.Children.map(a.children,((t,a)=>(o.isActive=a===e,o.isActive?function({type:e}){return"function"===typeof e||"object"===typeof e}(t)?i.a.cloneElement(t,o):t:null)));return Object(n.a)(i.a.Fragment,null,c);function s(e){l(e-1)}function l(n){e!==n&&(!function(e,t){return e<0||e>=t.length}(n,a.children)?t(n):console.error(`${n+1} is an invalid step`))}}const W=(e,t,a)=>{var n;const r=e&&{max:e},o=(null===t||void 0===t||null===(n=t.height)||void 0===n?void 0:n.ideal)||a;return{height:{...r,...o&&(e?{ideal:Math.min(o,e)}:{ideal:o})}}};async function $(e,t=null){try{const a=await navigator.mediaDevices.getUserMedia({audio:!t||{deviceId:t},video:!1});a.getTracks().forEach((t=>{t.onended=()=>{e({type:"AUDIO_UNEXPETED_END"})}})),e({type:"SHARE_AUDIO",payload:a})}catch(a){console.error("Error: "+a),e({type:"BLOCK_AUDIO"})}}async function q(e,t,a={}){var n,r;const o=(null===(n=t.display)||void 0===n?void 0:n.maxFps)?{frameRate:{max:t.display.maxFps}}:{},i=W(null===(r=t.display)||void 0===r?void 0:r.maxHeight,a),c={video:{cursor:"always",...o,...a,...i},audio:!1};try{const t=await navigator.mediaDevices.getDisplayMedia(c);t.getTracks().forEach((t=>{t.onended=()=>{e({type:"DISPLAY_UNEXPETED_END"})}})),e({type:"SHARE_DISPLAY",payload:t})}catch(s){console.error("Error: "+s),e({type:"BLOCK_DISPLAY"})}}async function G(e,t,a){var n,r;const o=(null===(n=t.camera)||void 0===n?void 0:n.maxFps)?{frameRate:{max:t.camera.maxFps}}:{},i=W(null===(r=t.camera)||void 0===r?void 0:r.maxHeight,a,1080),c={video:{facingMode:"user",...a,...o,...i},audio:!1};try{const t=await navigator.mediaDevices.getUserMedia(c);t.getTracks().forEach((t=>{t.onended=()=>{e({type:"USER_UNEXPETED_END"})}})),e({type:"SHARE_USER",payload:t})}catch(s){console.error("Error: "+s),e({type:"BLOCK_USER"})}}function K(e,t){null===e||void 0===e||e.getTracks().forEach((e=>e.stop())),t({type:"UNSHARE_AUDIO"})}function B(e,t){null===e||void 0===e||e.getTracks().forEach((e=>e.stop())),t({type:"UNSHARE_DISPLAY"})}function V(e,t){null===e||void 0===e||e.getTracks().forEach((e=>e.stop())),t({type:"UNSHARE_USER"})}var Y=a(109),X=a.n(Y),Q=a(40),J=a.n(Q),Z=a(103);Object(Z.configure)({defaultKeyEvent:"keydown",ignoreTags:["input"],ignoreEventsCondition:function(){},ignoreKeymapAndHandlerChangesByDefault:!1});const ee=e=>"Mac"===["Windows","Linux","Mac"].find((e=>navigator.userAgent.includes(e)))?e.replace("Alt","Option"):e,te="record-shortcuts",ae="edit-shortcuts",ne="other-shortcuts",re="control-key",oe="shift-key",ie="space-key",ce="left-key",se="right-key",le={RECORD_DISPLAY:{name:"record-display",sequences:["1"],description:["1"],group:te},RECORD_DISPLAY_CAMERA:{name:"record-both",sequences:["2"],description:["2"],group:te},RECORD_CAMERA:{name:"record-camera",sequences:["3"],description:["3"],group:te},RECORD_AUDIO:{name:"record-audio",sequences:["1"],description:["1"],group:te},NO_AUDIO:{name:"record-no-audio",sequences:["2"],description:["2"],group:te},START_RECORDING:{name:"start-recording",sequences:["r"],description:["r"],group:te},STOP_RECORDING:{name:"stop-recording",sequences:["s"],description:["s"],group:te},PAUSE_RECORDING:{name:"pause-recording",sequences:["Space","k"],description:[ie,"k"],group:te}},de={PLAY_PAUSE:{name:"play-pause",sequences:["Space","k"],description:[ie,"k"],group:ae},FORWARD_5_SEC:{name:"skip-five",sequences:["l","ArrowRight"],description:["l",se],group:ae},BACKWARDS_5_SEC:{name:"back-five",sequences:["j","ArrowLeft"],description:["j",ce],group:ae},FORWARD_1_FRAME:{name:"frame-forward",sequences:["."],description:["."],group:ae},BACKWARDS_1_FRAME:{name:"frame-back",sequences:[","],description:[","],group:ae},CUT_LEFT:{name:"cut-left",sequences:["n"],description:["n"],group:ae},CUT_RIGHT:{name:"cut-right",sequences:["m"],description:["m"],group:ae},DELETE_CROP_MARK_LEFT:{name:"delete-left",sequences:["Shift+n"],description:[oe+"+n"],group:ae},DELETE_CROP_MARK_RIGHT:{name:"delete-right",sequences:["Shift+m"],description:[oe+"+m"],group:ae}},ue={TAB:{name:"tab-elements",sequences:[],description:["Tab"],group:ne},NEXT_BUTTON:{name:"next-button",sequences:["Control+ArrowRight"],description:[re+"+"+se],group:ne},BACK_BUTTON:{name:"back-button",sequences:["Control+ArrowLeft"],description:[re+"+"+ce],group:ne},UPLOAD:{name:"upload-video",sequences:[ee("Alt+u")],description:[ee("Alt+u")],group:ne},DOWNLOAD:{name:"download-video",sequences:["d"],description:["d"],group:ne},NEW_RECORDING:{name:"new-recording",sequences:["Shift+n"],description:[oe+"+n"],group:ne}},be=({children:e})=>Object(n.a)("div",{sx:{display:"flex",flexDirection:"column",flex:"1 1 auto",justifyContent:"space-between",p:3,pt:[2,2,3],"& > h1":{textAlign:"center",fontSize:["24px","27px","32px"]}}},e);function pe({prev:e=null,next:t=null,children:a}){const{t:o}=Object(L.c)(),i={BACK_BUTTON:t=>{e&&e.onClick(t)},NEXT_BUTTON:e=>{t&&!t.disabled&&t.onClick(e)}};return Object(n.a)(Z.GlobalHotKeys,{keyMap:ue,handlers:i},Object(n.a)(r.e,{sx:{alignItems:"end",minHeight:"40px"}},Object(n.a)(r.a,{sx:{flex:"1 1 0",textAlign:"left"}},e&&Object(n.a)(r.b,{sx:{whiteSpace:"nowrap",...!0===e.danger?{variant:"buttons.danger"}:{variant:"buttons.text"}},onClick:e.onClick,disabled:e.disabled,danger:e.danger||!1},Object(n.a)(T.a,{icon:I.b}),o(e.label||"back-button-label"))),Object(n.a)(r.a,null,a),Object(n.a)(r.a,{sx:{flex:"1 1 0",textAlign:"right"}},t&&Object(n.a)(r.b,{sx:{whiteSpace:"nowrap","& svg":{mr:0,ml:2},...!0===t.danger?{variant:"buttons.danger"}:{}},onClick:t.onClick,disabled:t.disabled},o(t.label||"next-button-label"),Object(n.a)(T.a,{icon:I.c})))))}const ge=i.a.createContext(null),Oe=()=>i.a.useContext(ge);function he({gap:e=0,minWidth:t=180,minHeight:a=140,children:r}){const{ref:i,width:c=1,height:s=1}=X()(),[,l]=Object(o.useState)(0),d=Object(o.useRef)(r.map((()=>[void 0,void 0]))),u=e=>{e.forEach((([e,t],a)=>{e&&t&&(d.current[a]=[e,t])}))};let b=r.map((e=>e.dimensions()));u(b);const p=()=>{const e=r.map((e=>e.dimensions()));J()(e,b)||(b=e,u(b),l((e=>e+1)))},g=([e,t])=>e&&t?e/t:16/9;switch(r.length){case 1:{const e=r[0],o=g(d.current[0]);let l,u;return c>s*o?(u=s,l=s*o):(l=c,u=c/o),Object(n.a)(ge.Provider,{value:p},Object(n.a)("div",{ref:i,sx:{flex:"1 0 0",minHeight:a,display:"flex"}},Object(n.a)("div",{sx:{height:u,width:l,minWidth:`${t}px`,margin:"auto"}},e.body)))}case 2:{const o=d.current.map((e=>g(e))),{rowWidths:l,rowHeights:u}=(()=>{const t=c-e,a=o[0]+o[1];if(t>s*a)return{rowHeights:Array(2).fill(s),rowWidths:o.map((e=>s*e))};{const e=t/a;return{rowHeights:r.map((t=>e)),rowWidths:o.map((t=>e*t))}}})(),{colWidths:b,colHeights:O}=(()=>{const t=s-e,a=1/(1/o[0]+1/o[1]);if(c>t*a){const e=t*a;return{colHeights:r.map(((t,a)=>e/o[a])),colWidths:Array(2).fill(e)}}return{colHeights:r.map(((e,t)=>c/o[t])),colWidths:Array(2).fill(c)}})();let h,m,j;return l[0]*u[0]+l[1]*u[1]>b[0]*O[0]+b[1]*O[1]?(j="row",h=l,m=u):(j="column",h=b,m=O),Object(n.a)(ge.Provider,{value:p},Object(n.a)("div",{ref:i,sx:{flex:"1 0 0",display:"flex",flexDirection:j,justifyContent:"space-between",minHeight:a}},Object(n.a)("div",{sx:{height:m[0],width:h[0],minWidth:`${t}px`,margin:"auto"}},r[0].body),Object(n.a)("div",{sx:{height:m[1],width:h[1],minWidth:`${t}px`,margin:"auto"}},r[1].body)))}default:return Object(n.a)("p",null,"Internal error: too few or too many video streams")}}var me=({isDanger:e,...t})=>Object(n.a)("div",Object.assign({sx:{":not(:last-child)":{marginBottom:"1.5rem"},backgroundColor:e?"error":"gray.3",color:e?"notification_text":"currentColor",borderRadius:2,padding:3,position:"relative"}},t)),je=a(122),ve=a.n(je);function xe({stream:e}){const t=Object(o.useRef)();return Object(o.useEffect)((()=>{const a=t.current;if(a){const t=a.getContext("2d");t.lineWidth=2,t.strokeStyle="#f1c40f";const n=(new(window.AudioContext||window.webkitAudioContext)).createMediaStreamSource(e),r=new ve.a(n,{fftSize:1024});return r.animate(t),()=>r.stop()}return()=>{}}),[e]),Object(n.a)("canvas",{ref:t,width:"800px",height:"200px",sx:{width:"100%",maxHeight:"200px",minHeight:0,flex:"1 0 70px",bg:"rgba(0,0,0,0.8)",borderRadius:"7px"}})}const fe="ocStudioLastAudioDevice";function ye(e){const t=C(),{audioStream:a,audioChoice:r}=D(),o=()=>e.previousStep(),i=()=>e.nextStep(),c=()=>i(),s=async()=>{t({type:"CHOOSE_AUDIO",payload:p});const e=window.localStorage.getItem(fe);await $(t,e?{ideal:e}:null),await Object(b.i)(t)},l=()=>{a&&K(a,t),t({type:"CHOOSE_AUDIO",payload:g})},d=(()=>{switch(r){case g:return Object(n.a)(we,{selectNoAudio:c,selectMicrophone:s,backToVideoSetup:o});case p:return Object(n.a)(ke,{reselectSource:l,enterStudio:i});default:return"internal error :-("}})();return Object(n.a)(be,null,d)}const we=({selectNoAudio:e,selectMicrophone:t,backToVideoSetup:a})=>{const{t:i}=Object(L.c)(),c={RECORD_AUDIO:e=>{e&&t(e)},NO_AUDIO:t=>{t&&e(t)}};return Object(n.a)(Z.GlobalHotKeys,{keyMap:le,handlers:c},Object(n.a)(o.Fragment,null,Object(n.a)(A.b.h1,null,i("sources-audio-question")),Object(n.a)(r.e,{sx:{flexDirection:["column","row"],maxWidth:850,width:"100%",mx:"auto",mb:3,flex:"1 0 auto",maxHeight:["none","350px"],"& > :first-of-type":{mb:[3,0],mr:[0,3]}}},Object(n.a)(Se,{icon:I.q,label:i("sources-audio-microphone"),onClick:t}),Object(n.a)(Se,{icon:I.r,label:i("sources-audio-without-audio"),onClick:e})),Object(n.a)(pe,{prev:{onClick:a}})))},ke=({reselectSource:e,enterStudio:t})=>{var a,i,c;const{t:s}=Object(L.c)(),l=C(),d=D(),{audioStream:u,audioAllowed:p,audioUnexpectedEnd:g}=d,O=null===u||void 0===u||null===(a=u.getAudioTracks())||void 0===a||null===(i=a[0])||void 0===i||null===(c=i.getSettings())||void 0===c?void 0:c.deviceId,h=Object(b.c)(d.mediaDevices,"audioinput");Object(o.useEffect)((()=>{O&&window.localStorage.setItem(fe,O)}));const m=({min:e,max:t})=>Object(n.a)("div",{sx:{flex:1,maxHeight:t,minHeight:e}});let j;return j=u?Object(n.a)(o.Fragment,null,Object(n.a)(xe,{stream:u}),Object(n.a)("div",{sx:{display:"flex",width:"80%",my:3,fontSize:"18px",minWidth:"285px","align-items":"center"}},Object(n.a)("label",{htmlFor:"sources-audio-device",sx:{mr:3,display:"flex",flexDirection:"column",alignItems:"center"}},s("sources-audio-device"),":"),Object(n.a)("select",{id:"sources-audio-device",sx:{variant:"styles.select",flex:"1 0 0",minWidth:0},value:O,onChange:e=>(async e=>{u&&K(u,l),await $(l,{exact:e})})(e.target.value)},h.map(((e,t)=>Object(n.a)("option",{key:t,value:e.deviceId},e.label||"unlabeled microphone")))))):!1===p?Object(n.a)(o.Fragment,null,Object(n.a)(T.a,{icon:I.m,size:"3x"}),Object(n.a)(m,{min:"16px",max:"48px"}),Object(n.a)(me,{isDanger:!0},Object(n.a)(r.f,{as:"h3",mb:2},s("source-audio-not-allowed-title")),Object(n.a)(r.k,{variant:"text"},s("source-audio-not-allowed-text")))):!0===g?Object(n.a)(o.Fragment,null,Object(n.a)(T.a,{icon:I.m,size:"3x"}),Object(n.a)(m,{min:"16px",max:"48px"}),Object(n.a)(me,{isDanger:!0},Object(n.a)(r.k,{variant:"text"},s("error-lost-audio-stream")))):Object(n.a)(r.j,{size:"75"}),Object(n.a)(o.Fragment,null,Object(n.a)(A.b.h1,null,s("sources-audio-microphone-selected")),Object(n.a)("div",{sx:{maxWidth:850,width:"100%",mx:"auto",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flex:"1 0 auto",maxHeight:"400px"}},j),Object(n.a)(pe,{prev:{label:"sources-audio-reselect-audio",onClick:e},next:{onClick:t}}))},Se=({children:e,icon:t,label:a,onClick:r})=>Object(n.a)("button",{onClick:r,sx:{fontFamily:"inherit",color:"gray.0",backgroundColor:"gray.4",border:"2px solid black",borderRadius:"8px",flex:"0 1 50%",p:2,"&:hover":{boxShadow:e=>`0 0 10px ${e.colors.gray[2]}`,filter:"brightness(1.2)"}}},Object(n.a)("div",{sx:{display:"block",textAlign:"center",mb:3}},Object(n.a)(T.a,{icon:t,size:"3x"})),Object(n.a)("div",{sx:{fontSize:4}},a),e);var Ee=a(110),Re=a(131),Ce=a(36);const De=({errors:e,register:t,label:a,name:r,required:o,validate:i,type:c="text",...s})=>{const{t:l}=Object(L.c)();return Object(n.a)("div",{sx:{"&:not(:last-child)":{mb:3}}},Object(n.a)("label",{sx:{color:"text",display:"block",fontSize:2,fontWeight:"bold"}},a,Object(n.a)("div",{sx:{display:"block",boxSizing:"border-box",clear:"both",fontSize:2,position:"relative",textAlign:"left"}},Object(n.a)("input",Object.assign({"aria-invalid":e[r]?"true":"false","aria-describedby":`${r}Error`,autoComplete:"off",name:r,ref:t({validate:i,...o?{required:l("forms-validation-error-required")}:{}}),sx:{variant:"styles.input"},type:c},s)),e[r]&&Object(n.a)("p",{id:`${r}Error`,sx:{color:"error",fontSize:1,fontWeight:"body",mt:1}},e[r].message))))};var Ae=({onDownload:e,recording:t,title:a,presenter:o})=>{const{t:i,i18n:c}=Object(L.c)(),{deviceType:s,mimeType:l,url:d,downloaded:u,media:p}=t,g=i("desktop"===s?"sources-display":"sources-user"),O=Object(b.j)({mimeType:l,flavor:g,title:a,presenter:o});if(!d)return null;const h=p.size,m=e=>{const t=e<10?1:0;return e.toLocaleString(c.language,{minimumFractionDigits:t,maximumFractionDigits:t})},j=h<1e3?`${h} B`:h<999500?`${m(h/1e3)} KB`:h<9995e5?`${m(h/1e6)} MB`:`${m(h/1e9)} GB`;return Object(n.a)("div",{sx:{display:"flex",flexDirection:"column",flex:"0 0 auto",mx:2,pb:"12px",alignItems:"center"}},Object(n.a)("div",{sx:{position:"relative",height:"150px",border:e=>`2px solid ${e.colors.gray[1]}`}},Object(n.a)("video",{tabIndex:"-1",muted:!0,src:d,onLoadedData:e=>e.target.currentTime=0,preload:"auto",sx:{maxWidth:"100%",height:"100%"}}),u&&Object(n.a)("div",{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",justifyContent:"center",alignItems:"center",color:"primary",backgroundColor:"rgba(0, 0, 0, 0.4)"}},Object(n.a)(T.a,{icon:I.f,size:"4x"}))),Object(n.a)(r.b,{as:"a",role:"button",sx:{width:"100%",maxWidth:"215px",margin:"auto",mt:"10px"},target:"_blank",download:O,href:d,rel:"noopener noreferrer",onClick:e},Object(n.a)(T.a,{icon:I.j}),i("save-creation-download-button")," ","(",j,")"))};const Te="ocStudioLastPresenter";let Ie=[];function _e(e){const t=Object(u.e)(),{t:a}=Object(L.c)(),i=Object(Ce.n)(),{recordings:c,upload:s,title:l,presenter:d,start:b,end:p}=D(),g=C();function O(e){const t=Date.now();Ie.push({timestamp:t,progress:e});const a=Math.min(Ie.findIndex((e=>t-e.timestamp<5e3)),Math.max(0,Ie.length-6));Ie.splice(0,a);let n=null;if(Ie.length>=4){const a=t-Ie[0].timestamp,r=(e-Ie[0].progress)/a*1e3,o=1-e;n=Math.max(0,Math.round(o/r))}s.secondsLeft===n&&s.currentProgress===e||g({type:"UPLOAD_PROGRESS_UPDATE",payload:{secondsLeft:n,currentProgress:e}})}async function h(){g({type:"UPLOAD_REQUEST"}),Ie.push({timestamp:Date.now(),progress:0});const e=await i.upload({recordings:c.filter(Boolean),title:l,presenter:d,start:b,end:p,uploadSettings:t.upload,onProgress:O});switch(Ie=[],e){case Ce.l:g({type:"UPLOAD_SUCCESS"});break;case Ce.j:g({type:"UPLOAD_ERROR",payload:a("save-creation-upload-network-error")});break;case Ce.k:g({type:"UPLOAD_ERROR",payload:a("save-creation-upload-not-authorized")});break;case Ce.m:g({type:"UPLOAD_ERROR",payload:a("save-creation-upload-invalid-response")});break;default:g({type:"UPLOAD_ERROR",payload:a("save-creation-upload-unknown-error")})}}Object(o.useEffect)((()=>{const e=setInterval((()=>{if(s.state===x)if(Ie.length){const e=Ie[Ie.length-1];Date.now()-e.timestamp>3e3&&O(e.progress)}else O(0)}),1e3);return()=>clearInterval(e)}));const m=c.every((e=>e.downloaded)),j=(s.state===f||m)&&s.state!==x,y=s.state!==v||m,w=(()=>{if(s.state===v&&(i.getState()===Ce.i||i.getState()===Ce.c))return Object(n.a)(He,null);switch(s.state){case x:return Object(n.a)(ze,{currentProgress:s.currentProgress,secondsLeft:s.secondsLeft});case f:return Object(n.a)(Fe,null);default:return Object(n.a)(Me,{uploadState:s,handleUpload:h})}})();return Object(n.a)(r.d,{sx:{display:"flex",flexDirection:"column",flex:"1 0 auto"}},Object(n.a)(A.b.h1,{sx:{textAlign:"center",fontSize:["26px","30px","32px"]}},a(j?"save-creation-title-done":"save-creation-title")),Object(n.a)("div",{sx:{display:"flex",flexDirection:["column","column","row"],"& > *":{flex:["0","0","1 0 50%"],p:[2,2,"0 32px"],"&:last-child":{borderLeft:["none","none",e=>`1px solid ${e.colors.gray[3]}`]}}}},Object(n.a)("div",null,Object(n.a)(A.b.h2,{sx:{pb:1,borderBottom:e=>`1px solid ${e.colors.gray[2]}`}},a("save-creation-subsection-title-upload")),Object(n.a)("div",{sx:{margin:"auto"}},w)),Object(n.a)("div",null,Object(n.a)(A.b.h2,{sx:{pb:1,borderBottom:e=>`1px solid ${e.colors.gray[2]}`}},a("save-creation-subsection-title-download")),Object(n.a)(Le,{dispatch:g,title:l,presenter:d}))),Object(n.a)("div",{sx:{flex:"1 0 32px"}}),Object(n.a)(pe,{next:null,prev:y?null:{onClick:function(){e.previousStep()},disabled:!1}},j&&Object(n.a)(Ue,{goToFirstStep:e.firstStep})))}const Ue=({goToFirstStep:e})=>{var t;const{t:a}=Object(L.c)(),o=C(),i=Object(u.e)(),c=()=>{window.confirm(a("save-creation-new-recording-warning"))&&(o({type:"RESET"}),e())};let s;if(null===(t=i.return)||void 0===t?void 0:t.target)if(Pe(i)){var l;const e=(null===(l=i.return)||void 0===l?void 0:l.label)?a("save-creation-return-to",{label:i.return.label}):a("save-creation-return-to-no-label");s=Object(n.a)(r.b,{as:"a",title:e,href:i.return.target,sx:{whiteSpace:"nowrap",fontWeight:400,mb:2}},Object(n.a)(T.a,{icon:I.A}),e)}else console.warn("the given 'return.target' is not allowed (check 'return.allowedDomains' in 'settings.toml')");const d={NEW_RECORDING:e=>{e&&c()}};return Object(n.a)(Z.GlobalHotKeys,{keyMap:ue,handlers:d},Object(n.a)("div",{sx:{display:"flex",flexDirection:"column"}},s,Object(n.a)(r.b,{sx:{whiteSpace:"nowrap"},title:a("save-creation-new-recording"),onClick:c},Object(n.a)(T.a,{icon:I.x}),a("save-creation-new-recording"))))},Pe=e=>{var t;let a;try{a=new URL(e.return.target,window.location)}catch(n){return!1}return[window.location.hostname,...(null===(t=e.return)||void 0===t?void 0:t.allowedDomains)||[]].some((e=>a.hostname===e))&&("https:"===a.protocol||"http:"===a.protocol)},Le=({presenter:e,title:t})=>{const{t:a}=Object(L.c)(),i=C(),{recordings:c,start:s,end:l}=D(),d={DOWNLOAD:e=>{e&&(()=>{var e=document.querySelectorAll("a[href^='blob']");for(const t of e)t.click()})()}};return Object(n.a)(Z.GlobalHotKeys,{keyMap:ue,handlers:d},Object(n.a)(o.Fragment,null,(null!==s||null!==l)&&Object(n.a)(me,{sx:{display:"flex",flexDirection:"column",alignItems:"center"}},Object(n.a)(T.a,{icon:I.m,sx:{fontSize:"26px",mb:3}}),Object(n.a)("p",{sx:{m:0}},a("save-creation-download-cut-warning"))),Object(n.a)("div",{sx:{display:"flex",flexDirection:"row",justifyContent:["center","center","start"],flexWrap:"wrap"}},0===c.length?Object(n.a)(r.j,null):c.map(((a,r)=>Object(n.a)(Ae,{key:r,recording:a,presenter:e,title:t,onDownload:()=>i({type:"MARK_DOWNLOADED",payload:r})}))))))},He=()=>{const e=Object(s.h)(),[t]=Object(P.b)();return Object(n.a)(me,{key:"opencast-connection",isDanger:!0},Object(n.a)(L.a,{i18nKey:"warning-missing-connection-settings"},"Warning.",Object(n.a)(c.b,{to:{pathname:"/settings",search:e.search},sx:{variant:"styles.a",color:"dark"===t?"rgba(255, 255, 34, 0.8)":"#ff2"}},"settings")))},Me=({uploadState:e,handleUpload:t})=>{const{titleField:a=u.b,presenterField:i=u.b}=Object(u.e)().upload||{},{t:c}=Object(L.c)(),s=Object(Ce.n)(),l=C(),{recordings:d,title:b,presenter:p}=D(),g=p||window.localStorage.getItem(Te)||"",{errors:O,handleSubmit:h,register:m}=Object(Ee.a)();function j(e){const t=e.target;l({type:{title:"UPDATE_TITLE",presenter:"UPDATE_PRESENTER"}[t.name],payload:t.value}),"presenter"===t.name&&window.localStorage.setItem(Te,t.value)}Object(o.useEffect)((()=>{g!==p&&l({type:"UPDATE_PRESENTER",payload:g})}));const v=s.prettyServerUrl()?Object(n.a)(L.a,{i18nKey:"save-creation-upload-to"},"Upload to ",Object(n.a)("code",{sx:{backgroundColor:"rgba(0, 0, 0, 0.1)",borderRadius:"5px",padding:"1px 3px"}},{server:s.prettyServerUrl()})):c("save-creation-button-upload"),x=Object(o.useRef)(null),f={UPLOAD:e=>{var t;e&&(null===(t=x.current)||void 0===t||t.click())}};return Object(n.a)(Z.GlobalHotKeys,{keyMap:ue,handlers:f},Object(n.a)(o.Fragment,null,Object(n.a)(Ne,null),Object(n.a)("form",null,a!==u.a&&Object(n.a)(De,{name:"title",label:c("save-creation-label-title"),required:a===u.b,onChange:j,autoComplete:"off",defaultValue:b,errors:O,register:m}),i!==u.a&&Object(n.a)(De,{name:"presenter",label:c("save-creation-label-presenter"),required:i===u.b,onChange:j,autoComplete:"off",defaultValue:g,errors:O,register:m}),Object(n.a)(r.b,{disabled:0===d.length,onClick:h(t),ref:x},Object(n.a)(T.a,{icon:I.C}),v)),Object(n.a)(r.a,{sx:{mt:2}},e.state===y&&Object(n.a)(me,{isDanger:!0},e.error))))},Ne=()=>{const e=Object(s.h)(),t=Object(Ce.n)(),{t:a}=Object(L.c)(),i=Object(Re.a)(),[l,d]=Object(o.useState)(!1);if(Object(o.useEffect)((()=>{if(!t.isReadyToUpload()&&!l&&i){const e=setTimeout((async()=>{d(!0),await t.refreshConnection(),d(!1)}),5e3);return()=>clearTimeout(e)}})),t.isReadyToUpload())return null;let u,b;switch(t.getState()){case Ce.g:u=a("save-creation-warn-unreachable"),b=a("save-creation-warn-once-reestablished");break;case Ce.d:if(t.isLoginProvided()){const e=document.referrer;u=Object(n.a)(L.a,{i18nKey:"save-creation-warn-session-expired"},"Foo",e&&!e.includes(window.origin||"")?Object(n.a)(A.b.a,{href:e,target:"_blank",sx:{color:"#ff2"}},"bar"):Object(n.a)(o.Fragment,null,"bar"),"baz"),a("save-creation-warn-session-expired"),b=a("save-creation-warn-once-refreshed")}else u=Object(n.a)(L.a,{i18nKey:"save-creation-warn-login-failed"},"Failed.",Object(n.a)(c.b,{to:{pathname:"/settings",search:e.search},sx:{variant:"styles.a",color:"#ff2"}},"settings")),b=a("save-creation-warn-once-logged-in");break;case Ce.h:case Ce.e:u=a("save-creation-warn-server-problem")+" "+a("save-creation-warn-download-hint");break;default:u="Internal error :-("}return Object(n.a)(me,{isDanger:!0},Object(n.a)("div",{sx:{textAlign:"center",fontSize:"40px",lineHeight:1.3}},l?Object(n.a)(r.j,{size:"40"}):Object(n.a)(T.a,{icon:I.m})),Object(n.a)("p",{sx:{mb:0}},u),b&&Object(n.a)("p",{sx:{mb:0}},b,b&&" ",a("save-creation-warn-download-hint")))},ze=({currentProgress:e,secondsLeft:t})=>{const{t:a,i18n:i}=Object(L.c)(),c=Math.min(100,100*e).toLocaleString(i.language,{minimumFractionDigits:1,maximumFractionDigits:1});let s;return s=null===t?null:t<4?a("upload-time-a-few-seconds"):t<45?`${t} ${a("upload-time-seconds")}`:t<90?a("upload-time-a-minute"):t<2700?`${Math.round(t/60)} ${a("upload-time-minutes")}`:t<5400?a("upload-time-an-hour"):t<86400?`${Math.round(t/3600)} ${a("upload-time-hours")}`:null,Object(n.a)(o.Fragment,null,Object(n.a)("div",{sx:{display:"flex",mb:2}},Object(n.a)(r.k,{variant:"text"},c,"%"),Object(n.a)("div",{sx:{flex:1}}),Object(n.a)(r.k,{variant:"text"},s&&Object(n.a)(L.a,{i18nKey:"upload-time-left"},{time:s}," left"))),Object(n.a)(r.i,{max:1,value:e,variant:"styles.progress"},c),Object(n.a)(r.k,{variant:"text",sx:{textAlign:"center",mt:2}},a("upload-notification")))},Fe=()=>{const{t:e}=Object(L.c)();return Object(n.a)(o.Fragment,null,Object(n.a)("div",{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"130px",color:"primary"}},Object(n.a)(T.a,{icon:I.f,size:"4x"})),Object(n.a)(r.k,{variant:"text",sx:{textAlign:"center"}},e("message-upload-complete")),Object(n.a)(r.k,{sx:{textAlign:"center",mt:2}},e("message-upload-complete-explanation")))};var We=a(124);a(123),a(49);var $e=({content:e,...t})=>Object(n.a)(We.a,Object.assign({content:Object(n.a)("span",null," ",e," "),interactive:!0,sx:{fontSize:"16px",backgroundColor:e=>e.colors.tooltip,color:e=>e.colors.tooltip_text,lineHeight:"normal",fontFamily:"Open Sans"}},t),Object(n.a)("span",null," ",t.children," "));const qe=(e,t=!1)=>{const a=e.deviceId&&{deviceId:{[t?"exact":"ideal"]:e.deviceId}},n=Ke(e.aspectRatio),r=n&&{aspectRatio:{ideal:n}},o=Be(e.quality);return{...a,...r,...o&&{height:{ideal:o}}}},Ge=["4:3","16:9"],Ke=e=>({"4:3":4/3,"16:9":16/9}[e]||null),Be=e=>/^[0-9]+p$/.test(e)?parseInt(e):null,Ve="ocStudioLastVideoDevice",Ye="ocStudioCameraAspectRatio",Xe="ocStudioCameraQuality",Qe="ocStudioDisplayQuality",Je=()=>({deviceId:window.localStorage.getItem(Ve),aspectRatio:window.localStorage.getItem(Ye)||"auto",quality:window.localStorage.getItem(Xe)||"auto"}),Ze=()=>({quality:window.localStorage.getItem(Qe)||"auto"}),et=({isDesktop:e,stream:t})=>{const a=C(),r=Object(u.e)(),[i,c]=Object(o.useState)(0),{ref:s}=X()({onResize:()=>{var e;return c((null===(e=s.current)||void 0===e?void 0:e.offsetHeight)+4)}}),{t:l}=Object(L.c)(),d=e?Ze():Je(),b=n=>{const o={...d,...n},i=qe(o,!0);e?(window.localStorage.setItem(Qe,o.quality),B(t,a),q(a,r,i)):(window.localStorage.setItem(Ve,o.deviceId),window.localStorage.setItem(Ye,o.aspectRatio),window.localStorage.setItem(Xe,o.quality),V(t,a),G(a,r,i))};Object(o.useEffect)((()=>{const a=ct(t);!e&&a&&window.localStorage.setItem(Ve,a)}));const[p,g]=Object(o.useState)(!1),[O]=Object(P.b)();return Object(n.a)(o.Fragment,null,Object(n.a)("div",{sx:{position:"absolute",top:p?"8px":"-30px",left:0,right:0,textAlign:"center",transition:"top 0.2s"}},Object(n.a)("span",{sx:{color:"dark"===O?"gray.3":"gray.1",backgroundColor:"white",borderRadius:"10px",p:1,fontSize:"18px"}},Object(n.a)(tt,{stream:t}))),Object(n.a)("div",{sx:{position:"absolute",left:0,right:0,bottom:0,height:"100%",display:"flex",flexDirection:"column",justifyContent:"flex-end"}},Object(n.a)("div",{sx:{textAlign:"right"}},Object(n.a)($e,{offset:[0,25],content:l(p?"video-settings-close":"video-settings-open")},Object(n.a)("button",{onClick:()=>g((e=>!e)),sx:{border:"none",display:"inline-block",backgroundColor:"rgba(0, 0, 0, 0.5)",color:"white",p:"6px",m:2,fontSize:"30px",lineHeight:"1em",borderRadius:"10px",cursor:"pointer","&:hover":{backgroundColor:"rgba(0, 0, 0, 0.7)"},"&:hover > svg, &:focus > svg":{transform:p?"none":"rotate(45deg)"},"&:focus-visible":{outline:e=>`5px solid ${e.colors.primary}`,outlineOffset:"-2px",backgroundColor:"rgba(0, 0, 0, 0.7)",color:"white"}}},Object(n.a)(T.a,{icon:p?I.z:I.i,fixedWidth:!0,sx:{transition:p?"none":"transform 0.2s",width:"1em !important"}})))),Object(n.a)("div",{sx:{height:p?i||"auto":0,flex:"0 1 auto",transition:"height 0.2s",overflow:"hidden",backgroundColor:"background",fontSize:"18px",boxShadow:p?"0 0 15px rgba(0, 0, 0, 0.3)":"none"}},Object(n.a)("div",{tabIndex:"-1",sx:{border:e=>`1px solid ${e.colors.gray[0]}`,height:"100%",overflow:"auto"}},Object(n.a)("div",{ref:s,sx:{p:1,pb:"2px"}},Object(n.a)("div",{sx:{display:"grid",width:"100%",gridTemplateColumns:"auto 1fr",gridGap:"6px 12px",p:1}},!e&&Object(n.a)(ot,{updatePrefs:b,prefs:d,isExpanded:p}),Object(n.a)(rt,{isDesktop:e,updatePrefs:b,prefs:d,stream:t,settings:r,isExpanded:p})),Object(n.a)("div",{sx:{backgroundColor:"gray.4",m:2,py:1,px:2,fontSize:"16px",lineHeight:"20px",border:e=>`1px solid ${e.colors.gray[2]}`}},Object(n.a)(L.a,{i18nKey:"sources-video-preferences-note"},Object(n.a)("strong",null,"Note:")," Explanation.")))))))},tt=({stream:e})=>{var t,a;const n=null===e||void 0===e||null===(t=e.getVideoTracks())||void 0===t||null===(a=t[0])||void 0===a?void 0:a.getSettings(),r=n&&n.width&&n.height?`${n.width}\xd7${n.height}`:"",o=n&&n.frameRate?`${n.frameRate} fps`:"";return n?[r,o].join(", "):"..."},at=({children:e})=>Object(n.a)("div",{sx:{gridColumn:"0 1",display:"flex",flexDirection:"column",justifyContent:"center",hyphens:"auto"}},e),nt=({children:e})=>Object(n.a)("div",{tabIndex:-1,sx:{gridColumn:"1 2",overflowX:"auto",lineHeight:"30px","*:focus-visible":{outline:e=>`5px solid ${e.colors.primary}`,outlineOffset:"-3px"}}},e),rt=({isDesktop:e,updatePrefs:t,prefs:a,stream:r,settings:i,isExpanded:c})=>{var s,l;const{t:d}=Object(L.c)(),u=e=>t({quality:e}),p=(e=>{let t=[360,480,720,1080,1440,2160].filter((t=>!e||t<=e));return!e||0!==t.length&&t[t.length-1]===e||t.push(e),t.map((e=>`${e}p`))})(e?null===(s=i.display)||void 0===s?void 0:s.maxHeight:null===(l=i.camera)||void 0===l?void 0:l.maxHeight),g=e?"desktop":"user",[,O]=Object(b.b)(r);let h;if(O&&p.includes(a.quality)){const e=parseInt(a.quality);h=e===O?"ok":"warn"}return Object(n.a)(o.Fragment,null,Object(n.a)(at,null,d("sources-video-quality"),"*:"),Object(n.a)(nt,null,Object(n.a)(it,{isExpanded:c,id:`quality-auto-${g}`,value:"auto",name:`quality-${g}`,label:d("sources-video-quality-auto"),onChange:u,checked:p.every((e=>a.quality!==e))}),p.map((e=>Object(n.a)(o.Fragment,{key:`${e}-${g}`},Object(n.a)("wbr",null),Object(n.a)(it,{isExpanded:c,id:`quality-${e}-${g}`,value:e,name:`quality-${g}`,onChange:u,checked:a.quality===e,state:h}))))))},ot=({updatePrefs:e,prefs:t,isExpanded:a})=>{const{t:r}=Object(L.c)(),i=D(),c=ct(i.userStream),s=Object(b.c)(i.mediaDevices,"videoinput"),[l,d]=Object(b.b)(i.userStream);let u;if(l&&d&&Ge.includes(t.aspectRatio)){const e=l/d,a=Ke(t.aspectRatio);u=.97*a<e&&e<a/.97?"ok":"warn"}const p=t=>e({aspectRatio:t});return Object(n.a)(o.Fragment,null,Object(n.a)(at,null,Object(n.a)("label",{htmlFor:"sources-video-device"},r("sources-video-device"),":")),Object(n.a)(nt,null,Object(n.a)("select",{id:"sources-video-device",tabIndex:a?"0":"-1",sx:{variant:"styles.select"},value:c,onChange:t=>{return a=t.target.value,e({deviceId:a});var a}},s.map(((e,t)=>Object(n.a)("option",{key:t,value:e.deviceId},e.label))))),Object(n.a)(at,null,r("sources-video-aspect-ratio"),"*:"),Object(n.a)(nt,null,Object(n.a)(it,{isExpanded:a,id:"ar-auto",value:"auto",name:"aspectRatio",label:r("sources-video-aspect-ratio-auto"),onChange:p,checked:Ge.every((e=>t.aspectRatio!==e))}),Ge.map((e=>Object(n.a)(o.Fragment,{key:`ar-${e}`},Object(n.a)("wbr",null),Object(n.a)(it,{isExpanded:a,id:`ar-${e}`,value:e,name:"aspectRatio",onChange:p,checked:t.aspectRatio===e,state:u}))))))},it=({id:e,value:t,checked:a,name:r,onChange:i,label:c,isExpanded:s})=>Object(n.a)(o.Fragment,null,Object(n.a)("input",{type:"radio",onChange:e=>i(e.target.value),id:e,value:t,checked:a,name:r,sx:{display:"none","&+label":{border:e=>`2px solid ${e.colors.gray[0]}`,p:"1px 4px",borderRadius:"6px",mx:1},"&:checked+label":{bg:"gray.0",color:"background",fontWeight:"bold"}}}),Object(n.a)("label",{tabIndex:s?"0":"-1",onKeyDown:e=>("Enter"===e.key||" "===e.key)&&i(t),htmlFor:e},c||t)),ct=e=>{var t,a,n;return null===e||void 0===e||null===(t=e.getVideoTracks())||void 0===t||null===(a=t[0])||void 0===a||null===(n=a.getSettings())||void 0===n?void 0:n.deviceId},st=({warnings:e,inputs:t})=>{let a;switch(t.length){case 1:a=[{body:Object(n.a)(lt,{input:t[0]}),dimensions:()=>Object(b.b)(t[0].stream)}];break;case 2:a=[{body:Object(n.a)(lt,{input:t[0]}),dimensions:()=>Object(b.b)(t[0].stream)},{body:Object(n.a)(lt,{input:t[1]}),dimensions:()=>Object(b.b)(t[1].stream)}];break;default:return Object(n.a)("p",null,"Something went very wrong")}return Object(n.a)(o.Fragment,null,e,Object(n.a)(he,{minWidth:300,gap:20},a))},lt=({input:e,text:t})=>Object(n.a)(r.c,{sx:{height:"100%",overflow:"hidden",backgroundColor:"element_bg"}},Object(n.a)(dt,{input:e}),Object(n.a)(et,{isDesktop:e.isDesktop,stream:e.stream})),dt=({input:e})=>{const{allowed:t,stream:a,unexpectedEnd:i}=e,c=Oe(),s=Object(o.useRef)();if(Object(o.useEffect)((()=>{const e=s.current;return e&&(e.srcObject||(e.srcObject=a),e.addEventListener("resize",c)),()=>{e&&e.removeEventListener("resize",c)}}),[a,c]),!a){let e;return e=!1===t||i?Object(n.a)(T.a,{icon:I.m,size:"3x"}):Object(n.a)(r.j,{size:"75"}),Object(n.a)("div",{tabIndex:"-1",sx:{width:"100%",height:"100%",minHeight:"120px",display:"flex",justifyContent:"center",alignItems:"center"}},e)}return Object(n.a)("video",{tabIndex:"-1",ref:s,autoPlay:!0,muted:!0,sx:{minHeight:0,display:"block",width:"100%",height:"100%"}})};function ut({nextStep:e,userHasWebcam:t}){const{t:a}=Object(L.c)(),o=C(),i=D(),{displayStream:c,userStream:s,videoChoice:l}=i,d=e=>o({type:"CHOOSE_VIDEO",payload:e}),u=l===j||l===O?!c||!s:!(c||s),b=!1===i.userAllowed&&Object(n.a)(me,{key:"user-stream-warning",isDanger:!0},Object(n.a)(r.f,{as:"h3",mb:2},a("source-user-not-allowed-title")),Object(n.a)(r.k,null,a("source-user-not-allowed-text"))),p=!1===i.displayAllowed&&Object(n.a)(me,{key:"display-stream-warning",isDanger:!0},Object(n.a)(r.f,{as:"h3",mb:2},a("source-display-not-allowed-title")),Object(n.a)(r.k,null,a("source-display-not-allowed-text"))),g=(i.userUnexpectedEnd||i.displayUnexpectedEnd)&&Object(n.a)(me,{key:"unexpexted-stream-end-warning",isDanger:!0},Object(n.a)(r.k,null,a("error-lost-video-stream"))),v={isDesktop:!1,stream:s,allowed:i.userAllowed,unexpectedEnd:i.userUnexpectedEnd},x={isDesktop:!0,stream:c,allowed:i.displayAllowed,unexpectedEnd:i.displayUnexpectedEnd};let f,y,w;switch(l){case j:const e=qe(Je()),r=qe(Ze());y=a("sources-video-question"),f=!0,w=Object(n.a)(bt,{setActiveSource:d,userConstraints:e,displayConstraints:r,userHasWebcam:t});break;case m:y=a("sources-video-user-selected"),f=!s&&!1!==i.userAllowed,w=Object(n.a)(st,{warnings:[b,g],inputs:[v]});break;case h:y=a("sources-video-display-selected"),f=!c&&!1!==i.displayAllowed,w=Object(n.a)(st,{warnings:[p,g],inputs:[x]});break;case O:y=a("sources-video-display-and-user-selected"),f=!s&&!1!==i.userAllowed||!c&&!1!==i.displayAllowed,w=Object(n.a)(st,{warnings:[p,b,g],inputs:[x,v]});break;default:return console.error("bug: active source has an unexpected value"),Object(n.a)("p",null,"Something went very wrong (internal error) :-(")}const k=f&&!i.userUnexpectedEnd&&!i.displayUnexpectedEnd;return Object(n.a)(be,null,Object(n.a)(A.b.h1,null,y),w,l!==j&&Object(n.a)("div",{sx:{mb:3}}),l!==j&&Object(n.a)(pe,{next:f?null:{onClick:()=>e(),disabled:u},prev:k?null:{onClick:()=>{d(j),V(s,o),B(c,o)},disabled:!1,label:"sources-video-reselect-source"}}))}const bt=({setActiveSource:e,userConstraints:t,displayConstraints:a,userHasWebcam:o})=>{const{t:c}=Object(L.c)(),s=Object(u.e)(),l=C(),d=D(),{displaySupported:p,userSupported:g}=d,j={RECORD_DISPLAY:e=>{e&&x(e)},RECORD_CAMERA:e=>{e&&v(e)},RECORD_DISPLAY_CAMERA:e=>{e&&f(e)}},v=async()=>{e(m),await G(l,s,t),await Object(b.i)(l)},x=async()=>{e(h),await q(l,s,a)},f=async()=>{e(O),await G(l,s,t),await Promise.all([Object(b.i)(l),q(l,s,a)])};return p||g?Object(n.a)(i.a.Fragment,null,Object(n.a)(Z.GlobalHotKeys,{keyMap:le,handlers:j},Object(n.a)(gt,null),Object(n.a)(r.e,{sx:{flexDirection:["column","row"],maxWidth:[270,850],width:"100%",mx:["auto","none"],mb:3,flex:"4 1 auto",maxHeight:["none","270px"],justifyContent:"center","& > :not(:last-of-type)":{mb:[3,0],mr:[0,3]}}},(p||!Object(b.g)())&&Object(n.a)(pt,{label:c("sources-scenario-display"),icon:I.d,onClick:x,disabledText:!p&&c("sources-video-display-not-supported")}),(p||!Object(b.g)())&&g&&Object(n.a)(pt,{label:c("sources-scenario-display-and-user"),icon:I.e,onClick:f,disabledText:p?!o&&c("sources-video-no-cam-detected"):c("sources-video-display-not-supported")}),g&&Object(n.a)(pt,{label:c("sources-scenario-user"),icon:I.D,onClick:v,disabledText:!o&&c("sources-video-no-cam-detected")})),Object(n.a)(gt,null))):Object(n.a)(me,{isDanger:!0},c("sources-video-none-available"))},pt=({icon:e,label:t,onClick:a,disabledText:r=!1})=>{const o=!1!==r;return Object(n.a)("button",{onClick:a,disabled:o,sx:{fontFamily:"inherit",color:o?"gray.2":"gray.0",border:e=>`2px solid ${o?e.colors.gray[2]:"black"}`,backgroundColor:"gray.4",borderRadius:"8px",flex:["1 1 auto","0 1 100%"],minWidth:"180px",maxWidth:"300px",minHeight:"120px",maxHeight:"250px",p:2,"&:hover":o?{}:{boxShadow:e=>`0 0 10px ${e.colors.gray[2]}`,filter:"brightness(1.2)"}}},Object(n.a)("div",{sx:{display:"block",textAlign:"center",mb:3}},Object(n.a)(T.a,{icon:e,size:"3x"})),Object(n.a)("div",{sx:{fontSize:4}},t),Object(n.a)("div",{sx:{fontSize:2,mt:1}},r))},gt=e=>Object(n.a)("div",Object.assign({sx:{flex:"1 0 0"}},e));function Ot({recordingState:e}){const{t:t}=Object(L.c)(),{displayStream:a,userStream:r,displayUnexpectedEnd:o,userUnexpectedEnd:i}=D(),c=e===Ft;let s=[];return(a||o)&&s.push({body:Object(n.a)(ht,{title:t("share-desktop"),stream:a,paused:c}),dimensions:()=>Object(b.b)(a)}),(r||i)&&s.push({body:Object(n.a)(ht,{title:t("share-camera"),stream:r,paused:c}),dimensions:()=>Object(b.b)(r)}),Object(n.a)(he,{gap:20},s)}function ht({title:e,stream:t,paused:a}){const r=Oe(),i=Object(o.useRef)();return Object(o.useEffect)((()=>{const e=i.current;if(e&&t)return e.srcObject||(e.srcObject=t),e.addEventListener("resize",r),a?e.pause():e.play(),()=>e.removeEventListener("resize",r)})),t?Object(n.a)("div",{sx:{position:"relative",backgroundColor:"gray.3",boxShadow:"0 2px 2px rgba(0, 0, 0, 0.35)",overflow:"hidden",height:"100%",cursor:t?"initial":"pointer"}},a&&Object(n.a)("div",{sx:{position:"absolute",width:"100%",height:"100%",backgroundColor:"rgba(255, 255, 255, 0.5)"}},Object(n.a)(T.a,{icon:I.s,sx:{color:"#000",fontSize:"140px",maxWidth:"40%",maxHeight:"40%",position:"absolute",top:0,left:0,bottom:0,right:0,margin:"auto",animation:"3s ease-in-out infinite none pulse"}})),Object(n.a)("video",{ref:i,autoPlay:!0,muted:!0,tabIndex:"-1",sx:{outline:"none",width:"100%",height:"100%",background:"transparent"}})):Object(n.a)("div",{sx:{width:"100%",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}},Object(n.a)(T.a,{icon:I.m,size:"3x"}))}var mt=a(2),jt=a(15),vt=Object(jt.a)("recorder"),xt=Object(jt.a)("data"),ft=Object(jt.a)("dimensions"),yt=Object(jt.a)("reset"),wt=Object(jt.a)("onDataAvailable"),kt=Object(jt.a)("onStop");class St{constructor(e,t,a={}){let n;Object.defineProperty(this,vt,{writable:!0,value:void 0}),Object.defineProperty(this,xt,{writable:!0,value:void 0}),Object.defineProperty(this,ft,{writable:!0,value:void 0}),Object.defineProperty(this,yt,{writable:!0,value:()=>{Object(mt.a)(this,xt)[xt]=[]}}),Object.defineProperty(this,wt,{writable:!0,value:e=>{e.data.size>0?Object(mt.a)(this,xt)[xt].push(e.data):console.log("Recording data has size 0!",e)}}),Object.defineProperty(this,kt,{writable:!0,value:e=>{var t,a;const n=(null===(t=Object(mt.a)(this,xt)[xt][0])||void 0===t?void 0:t.type)||Object(mt.a)(this,vt)[vt].mimeType,r=new Blob(Object(mt.a)(this,xt)[xt],{type:n}),o=URL.createObjectURL(r);Object(mt.a)(this,yt)[yt](),null===(a=this.onStop)||void 0===a||a.call(this,{url:o,media:r,mimeType:n,dimensions:Object(mt.a)(this,ft)[ft]})}}),"isTypeSupported"in MediaRecorder?(n=((null===t||void 0===t?void 0:t.mimes)||[]).find((e=>MediaRecorder.isTypeSupported(e))),n?console.debug("using first supported MIME type from settings: ",n):(null===t||void 0===t?void 0:t.mimes)&&console.debug("None of the MIME types specified in settings are supported by this `MediaRecorder`")):(null===t||void 0===t?void 0:t.mimes)&&console.debug("MIME types were specified, but `MediaRecorder.isTypeSupported` is not supported by your browser"),Object(mt.a)(this,yt)[yt](),Object(mt.a)(this,ft)[ft]=Object(b.b)(e);const r=null===t||void 0===t?void 0:t.videoBitrate;this.onStop=a.onStop,Object(mt.a)(this,vt)[vt]=new MediaRecorder(e,{mimeType:n,videoBitsPerSecond:r}),Object(mt.a)(this,vt)[vt].ondataavailable=Object(mt.a)(this,wt)[wt],Object(mt.a)(this,vt)[vt].onstop=Object(mt.a)(this,kt)[kt]}start(){Object(mt.a)(this,vt)[vt].start()}pause(){Object(mt.a)(this,vt)[vt].pause()}resume(){Object(mt.a)(this,vt)[vt].resume()}stop(){Object(mt.a)(this,vt)[vt].stop()}}const Et=({large:e,...t})=>Object(n.a)("button",Object.assign({sx:{display:"grid",backgroundColor:"transparent",border:"none",position:"relative",overflow:"hidden",my:0,mx:e?"15px":0,padding:0,fontSize:e?"5rem":"3.5rem",lineHeight:e?"5rem":"3.5rem",svg:{margin:0,padding:0,outline:"none"}}},t)),Rt=e=>Object(n.a)(Et,{onClick:e.onClick,title:e.title,sx:{"&:focus-visible":{outline:e=>`7px solid ${e.colors.focus[3]} !important`,outlineOffset:"-1px",borderRadius:"50%"}}},Object(n.a)("span",{className:"fa-layers"},Object(n.a)(T.a,{icon:I.t,sx:{color:"button_bg"}}))),Ct=e=>Object(n.a)(Et,{onClick:e.onClick,title:e.title,large:e.large?1:0,disabled:e.disabled||e.countdown,sx:{color:"#bd181c !important","svg + svg":{color:"#e22319"},":disabled":{color:"#aaa"},":disabled svg + svg":{color:"#bbb"},"&:focus-visible":{outline:e=>`7px solid ${e.colors.focus[0]} !important`,outlineOffset:"-1px",borderRadius:"50%"}}},Object(n.a)("span",{className:"fa-layers record-buttons"},Object(n.a)(T.a,{icon:e.countdown?I.h:I.g,spin:e.countdown}),Object(n.a)(T.a,{icon:I.g,transform:"shrink-6"}))),Dt=e=>Object(n.a)(Et,{onClick:e.onClick,title:e.title,sx:{"&:focus-visible":{outline:e=>`7px solid ${e.colors.focus[3]} !important`,outlineOffset:"-1px",borderRadius:"50%"}}},Object(n.a)("span",{className:"fa-layers"},Object(n.a)(T.a,{icon:I.w,sx:{color:"button_bg"}}))),At=e=>Object(n.a)(Et,{onClick:e.onClick,title:e.title,large:!!e.large,sx:{color:"#bd181c","&:focus-visible":{outline:e=>`7px solid ${e.colors.focus[0]} !important`,outlineOffset:"-1px",borderRadius:"50%"}}},Object(n.a)(T.a,{icon:I.y,sx:{color:"#bd181c !important"}}));var Tt=Object(jt.a)("last"),It=Object(jt.a)("timerID"),_t=Object(jt.a)("isMounted");class Ut extends o.Component{constructor(e){super(e),Object.defineProperty(this,Tt,{writable:!0,value:null}),Object.defineProperty(this,It,{writable:!0,value:null}),Object.defineProperty(this,_t,{writable:!0,value:!1}),this.state={milliseconds:0},Object(mt.a)(this,Tt)[Tt]=new Date,Object(mt.a)(this,It)[It]=setInterval((()=>this.tick()),100)}componentDidMount(){Object(mt.a)(this,_t)[_t]=!0}componentWillUnmount(){this.stopTimer(),Object(mt.a)(this,_t)[_t]=!1}resumeTimer(){this.timerId||(Object(mt.a)(this,It)[It]=setInterval((()=>this.tick()),100),Object(mt.a)(this,Tt)[Tt]=new Date)}stopTimer(){clearInterval(Object(mt.a)(this,It)[It]),Object(mt.a)(this,It)[It]=null}componentDidUpdate(e){this.props.isPaused!==e.isPaused&&(this.props.isPaused?this.stopTimer():this.resumeTimer())}tick(){if(Object(mt.a)(this,_t)[_t]){const e=new Date,t=e-Object(mt.a)(this,Tt)[Tt];Object(mt.a)(this,Tt)[Tt]=e,this.setState((e=>({milliseconds:e.milliseconds+t})))}}render(){const e=this.state.milliseconds;let t=[e/36e5>>0,(e/6e4>>0)%60,(e/1e3>>0)%60];0===t[0]&&(t=t.slice(1));const a=t.map((e=>(e<10?"0":"")+e)).join(":");return Object(n.a)("span",{sx:{fontSize:3}},a)}}var Pt=Ut;function Lt(e,t){return({media:a,url:n,mimeType:r,dimensions:o})=>{e({type:"ADD_RECORDING",payload:{deviceType:t,media:a,url:n,mimeType:r,dimensions:o}})}}function Ht(e,t){return(null===e||void 0===e?void 0:e.getAudioTracks().length)?new MediaStream([...t.getVideoTracks(),...e.getAudioTracks()]):t}let Mt=[];function Nt({handleRecorded:e,recordingState:t,setRecordingState:a}){const{t:r}=Object(L.c)(),i=C(),c=Object(u.e)(),{audioStream:d,displayStream:b,userStream:p,userUnexpectedEnd:g,displayUnexpectedEnd:O,audioUnexpectedEnd:h}=D(),m=Object(o.useRef)(null),j=Object(o.useRef)(null),v=(b||p)&&!g&&!O&&!h,x=Object(s.g)(),f=(t=!1)=>{var a,n;null===(a=m.current)||void 0===a||a.stop(),null===(n=j.current)||void 0===n||n.stop(),e(),i({type:t?"STOP_RECORDING_PREMATURELY":"STOP_RECORDING"}),Mt.forEach((e=>e())),Mt=[]};Object(o.useEffect)((()=>{!(g||O||h)||t!==Wt&&t!==Ft||f(!0),x.listen((()=>{"STATE_INACTIVE"!==t&&i({type:"STOP_RECORDING"}),Mt.forEach((e=>e())),Mt=[]}))}));const y=()=>{a(Ft),(()=>{var e,t;null===(e=m.current)||void 0===e||e.pause(),null===(t=j.current)||void 0===t||t.pause()})()},w=()=>{a(Wt),(()=>{var e,t;null===(e=m.current)||void 0===e||e.resume(),null===(t=j.current)||void 0===t||t.resume()})()},k=()=>{v&&(a(Wt),(()=>{if(i({type:"CLEAR_RECORDINGS"}),b){const e=Lt(i,"desktop"),t=Ht(d,b);m.current=new St(t,c.recording,{onStop:e}),m.current.start()}if(p){const e=Lt(i,"video"),t=Ht(d,p);j.current=new St(t,c.recording,{onStop:e}),j.current.start()}i({type:"START_RECORDING"}),Mt.push(x.block(r("confirm-cancel-recording")))})())},S=()=>{a(zt),f()},E={START_RECORDING:e=>{e&&k()},STOP_RECORDING:e=>{e&&S()},PAUSE_RECORDING:e=>{e&&(t===Wt?y():t===Ft&&w())}};return Object(n.a)(Z.GlobalHotKeys,{keyMap:le,handlers:E},Object(n.a)("div",{sx:{m:0,width:t!==zt?"280px":"auto"}},t!==zt&&Object(n.a)(l.a,{onBeforeunload:e=>e.preventDefault()}),Object(n.a)("div",{className:"buttons",sx:{display:"flex",alignItems:"center"}},t!==zt&&Object(n.a)("div",{sx:{flex:1,textAlign:"right"}},t===Wt&&Object(n.a)($e,{content:r("pause-button-title"),offset:[0,50]},Object(n.a)(Rt,{recordingState:t,onClick:y})),t===Ft&&Object(n.a)($e,{content:r("resume-button-title"),offset:[0,50]},Object(n.a)(Dt,{recordingState:t,onClick:w}))),Object(n.a)("div",{className:"center"},t===zt?Object(n.a)($e,{content:r("record-button-title"),offset:[0,50]},Object(n.a)(Ct,{large:!0,recordingState:t,onClick:k,disabled:!v})):Object(n.a)($e,{content:r("stop-button-title"),offset:[0,50]},Object(n.a)(At,{large:!0,recordingState:t,onClick:S}))),t!==zt&&Object(n.a)("div",{sx:{flex:1}},Object(n.a)(Pt,{isPaused:t===Ft})))))}const zt="inactive",Ft="paused",Wt="recording";function $t(e){const{t:t}=Object(L.c)(),a=D(),i=C(),c=Object(Ce.n)(),[s,l]=Object(o.useState)(zt),d=Object(o.useCallback)((()=>{e.previousStep()}),[e]);return Object(n.a)(r.e,{sx:{flexDirection:"column",height:"100%",position:"relative",flexGrow:1}},(a.displayUnexpectedEnd||a.userUnexpectedEnd)&&Object(n.a)(me,{isDanger:!0},Object(n.a)(r.k,null,t("error-lost-video-stream"))),a.audioUnexpectedEnd&&Object(n.a)(me,{isDanger:!0},Object(n.a)(r.k,null,t("error-lost-audio-stream"))),Object(n.a)(Ot,{recordingState:s}),Object(n.a)("div",{sx:{m:3}},Object(n.a)(pe,{prev:s===zt&&{onClick:d}},Object(n.a)(Nt,{handleRecorded:()=>{c.refreshConnection(),function({audioStream:e,displayStream:t,userStream:a},n){K(e,n),B(t,n),V(a,n)}(a,i),e.nextStep()},recordingState:s,setRecordingState:l}))))}var qt;function Gt(){return(Gt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Kt({title:e,titleId:t,...a},n){return o.createElement("svg",Gt({"aria-hidden":"true",focusable:"false",role:"img",viewBox:"0 0 100 65",xmlns:"http://www.w3.org/2000/svg",ref:n,"aria-labelledby":t},a),e?o.createElement("title",{id:t},e):null,qt||(qt=o.createElement("path",{d:"m24.6 0c-0.447 0-0.894 0.171-1.24 0.511l-3.07 3.05c-0.685 0.681-0.685 1.78 0 2.46l58.8 58.5c0.685 0.681 1.79 0.681 2.47 0l3.07-3.05c0.685-0.681 0.685-1.78 0-2.46l-6.68-6.64h22v-7.32h-15.6c-1.44 0-2.6-1.15-2.6-2.59v-14.3c0-1.43 1.16-2.59 2.6-2.59h15.6v-7.32h-56.4l-17.8-17.7c-0.343-0.341-0.79-0.511-1.24-0.511zm-24.6 18.2v7.32h3.7c1.44 0 2.6 1.15 2.6 2.59v14.3c0 1.43-1.16 2.59-2.6 2.59h-3.7v7.32h55.8l-15.4-15.3v5.36c0 1.43-1.16 2.59-2.6 2.59h-21.8c-1.44 0-2.6-1.15-2.6-2.59v-14.3c0-1.43 1.16-2.59 2.6-2.59h12.8l-7.36-7.32zm51 7.32h21c1.44 0 2.6 1.15 2.6 2.59v14.3c0 1.43-1.16 2.59-2.6 2.59h-1.4z",fill:"currentColor"})))}const Bt=o.forwardRef(Kt);var Vt;a.p;function Yt(){return(Yt=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}function Xt({title:e,titleId:t,...a},n){return o.createElement("svg",Yt({"aria-hidden":"true",focusable:"false",role:"img",viewBox:"0 0 100 90",xmlns:"http://www.w3.org/2000/svg",ref:n,"aria-labelledby":t},a),e?o.createElement("title",{id:t},e):null,Vt||(Vt=o.createElement("g",{fill:"currentColor"},o.createElement("path",{d:"m49.7 0.00188c-2.91 0.0589-5.75 1.49-7.44 4.08-1.06 1.62-1.51 3.48-1.42 5.29-0.0794 0.122-0.986 1.51-1.13 1.72-0.13-0.2-0.997-1.54-1.08-1.66 0.0951-1.81-0.348-3.67-1.4-5.29-1.68-2.59-4.51-4.04-7.42-4.11-1.75-0.0426-3.52 0.41-5.09 1.41-4.18 2.66-5.4 8.27-2.72 12.4 2.56 3.96 7.83 5.24 11.9 3.02l0.992 1.53c-2.84 4.35-4.9 7.5-6.74 10.3-3.09 4.73-1.94 8.93 2.01 11.5l9.47-14.5 9.45 14.6c3.96-2.55 5.13-6.75 2.06-11.5-1.84-2.84-3.9-6.03-6.74-10.4l1.04-1.59c4.1 2.23 9.37 0.974 12-2.97 2.03-3.1 1.85-7.03-0.114-9.93-0.656-0.968-1.51-1.82-2.55-2.49-1.56-1.01-3.33-1.47-5.08-1.43zm0.0903 5.96c0.578-0.0076 1.17 0.154 1.7 0.499 0.357 0.23 0.649 0.514 0.872 0.835 0.668 0.962 0.712 2.24 0.0174 3.31-0.926 1.42-2.74 1.8-4.17 0.882-1.43-0.919-1.82-2.73-0.889-4.14 0.579-0.886 1.51-1.37 2.47-1.38zm-20.1 0.0236c0.963 0.0168 1.89 0.504 2.46 1.39 0.92 1.42 0.525 3.22-0.906 4.14s-3.25 0.521-4.17-0.9c-0.92-1.42-0.525-3.22 0.906-4.14 0.537-0.343 1.13-0.502 1.71-0.492zm10 24.1a1.83 1.81 0 0 0-1.83 1.81v3.62a1.83 1.81 0 0 0 1.83 1.81 1.83 1.81 0 0 0 1.83-1.81v-3.62a1.83 1.81 0 0 0-1.83-1.81zm0 10.9a1.83 1.81 0 0 0-1.83 1.81v3.62a1.83 1.81 0 0 0 1.83 1.81 1.83 1.81 0 0 0 1.83-1.81v-3.62a1.83 1.81 0 0 0-1.83-1.81zm-1.5 8.8a2.43 2.42 0 0 0-2.43 2.42v35.4a2.43 2.42 0 0 0 2.43 2.42h8.94v-4.83h-6.51v-30.6h6.1v-4.83zm6.51 8.86v22.5h55.2v-4.83h-3.22c-0.954 0-1.72-0.761-1.72-1.71v-9.47c0-0.946 0.767-1.71 1.72-1.71h3.22v-4.83zm6.59 4.83h14.4c0.954 0 1.72 0.762 1.72 1.71v9.47c0 0.946-0.767 1.71-1.72 1.71h-14.4c-0.954 0-1.72-0.761-1.72-1.71v-9.47c0-0.946 0.767-1.71 1.72-1.71zm22.7 0h14.4c0.954 0 1.72 0.762 1.72 1.71v9.47c0 0.946-0.767 1.71-1.72 1.71h-14.4c-0.954 0-1.72-0.761-1.72-1.71v-9.47c0-0.946 0.769-1.71 1.72-1.71z"}),o.createElement("path",{d:"m0 58.6v4.83h2.44c0.954 0 1.72 0.762 1.72 1.71v9.47c0 0.946-0.768 1.71-1.72 1.71h-2.44v4.83h31.8v-22.5zm10.8 4.83h14.4c0.954 0 1.72 0.762 1.72 1.71v9.47c0 0.946-0.768 1.71-1.72 1.71h-14.4c-0.954 0-1.72-0.762-1.72-1.71v-9.47c0-0.946 0.768-1.71 1.72-1.71z",opacity:.2}))))}const Qt=o.forwardRef(Xt);a.p;function Jt(e){const{t:t}=Object(L.c)(),a=C(),{recordings:i,prematureRecordingEnd:c,videoChoice:s}=D(),l=i.some((e=>0===e.media.size)),d=Object(o.useRef)(),[u,b]=Object(o.useState)(0),[p,g]=Object(o.useState)(),O=(()=>{switch(s){case"none":return 0;case"both":return 2;default:return 1}})();return Object(n.a)(be,null,Object(n.a)(A.b.h1,null,t("review-heading")),c&&Object(n.a)(me,{isDanger:!0},Object(n.a)(r.k,null,t("error-lost-stream-end-recording"))),l&&Object(n.a)(me,{isDanger:!0},t("review-error-empty-recording")),(!p||i.length!==O)&&Object(n.a)("div",{sx:{flex:1,display:"flex",alignItems:"center",justifyContent:"center"}},Object(n.a)(r.j,{title:t("save-creation-waiting-for-recordings")})),i.length===O&&Object(n.a)("div",{sx:p?{display:"flex",flex:"1 1 auto",flexDirection:"column"}:{display:"none"}},Object(n.a)(na,{ref:d,onTimeUpdate:e=>{b(e.target.currentTime)},onReady:()=>g(!0)}),Object(n.a)("div",{sx:{mb:3}}),Object(n.a)(Zt,{previewController:d,currentTime:u})),Object(n.a)("div",{sx:{mb:3}}),Object(n.a)(pe,{prev:{onClick:()=>{window.confirm(t("confirm-discard-recordings"))&&(a({type:"RESET"}),e.firstStep())},danger:!0,label:"review-button-discard-and-record"},next:{onClick:()=>{e.nextStep()}}}))}const Zt=({previewController:e,currentTime:t})=>Object(n.a)("div",{sx:{backgroundColor:"gray.4",color:"text",borderRadius:"8px"}},Object(n.a)(ta,{previewController:e,currentTime:t}),Object(n.a)(ea,{previewController:e,currentTime:t})),ea=({previewController:e,currentTime:t})=>{var a;const r=(null===(a=e.current)||void 0===a?void 0:a.duration)||1/0,{start:o,end:i}=D(),[c]=Object(P.b)(),s=t=>{const a=t.target.getBoundingClientRect();let n=(t.clientX-a.x)/a.width;n<0?n=0:n>1&&(n=1),e.current&&(e.current.currentTime=n*r)},l={position:"absolute",backgroundColor:"dark"===c?"gray.2":"gray.3",height:"100%",boxSizing:"content-box"};return Object(n.a)("div",{sx:{p:2}},Object(n.a)("div",{sx:{py:1,position:"relative"}},Object(n.a)("div",{onClick:e=>s(e),onMouseMove:e=>{1===e.buttons&&s(e)},sx:{position:"absolute",width:"100%",height:"100%",cursor:"pointer",top:0,zIndex:10}}),Object(n.a)("div",{sx:{position:"relative",backgroundColor:"#6bc295",height:"12px",width:"100%",borderRadius:"6px",overflow:"hidden","@media not (any-pointer: fine)":{height:"20px",borderRadius:"10px"}}},null!=o&&o>0&&Object(n.a)("div",{sx:{left:0,borderRight:"2px solid black",width:o/r*100+"%",...l}}),null!=i&&i<r&&Object(n.a)("div",{sx:{right:0,borderLeft:"2px solid black",width:(r-i)/r*100+"%",...l}}),Object(n.a)("div",{sx:{position:"absolute",left:0,width:t/r*100+"%",backgroundColor:"black",height:"100%",opacity:.3}}))))},ta=({currentTime:e,previewController:t})=>{var a,i,c,s,l;const{start:d,end:b}=D(),p=C(),g=Object(u.e)(),{t:O}=Object(L.c)(),h=null===(a=t.current)||void 0===a?void 0:a.duration,m=Object(o.useRef)(null),j=Object(o.useRef)(null),v={PLAY_PAUSE:e=>{e&&(e=>{const a=t.current;a.isPlaying?a.pause(e):a.isReadyToPlay&&a.play(e)})(e)},DELETE_CROP_MARK_LEFT:e=>{var t;e&&(null===(t=m.current)||void 0===t||t.click())},DELETE_CROP_MARK_RIGHT:e=>{var t;e&&(null===(t=j.current)||void 0===t||t.click())}};return Object(n.a)("div",{sx:{textAlign:"center"}},Object(n.a)(Z.GlobalHotKeys,{keyMap:de,handlers:v},Object(n.a)(r.e,{sx:{backgroundColor:"gray.4",p:2,justifyContent:"center",alignItems:"flex-end","& > *":{mx:2}}},(null===(i=g.review)||void 0===i?void 0:i.disableCutting)||Object(n.a)(aa,{marker:"start",innerRef:m,value:d,control:b,invariant:(e,t)=>e<t,recordingDispatch:p,previewController:t,currentTime:e}),Object(n.a)($e,{content:(null===(c=t.current)||void 0===c?void 0:c.isPlaying)?O("review-pause"):O("review-play")},Object(n.a)("button",{sx:{backgroundColor:"transparent",border:"none",mx:3,color:"gray.0"},onClick:()=>{const e=t.current;e&&(e.isPlaying?e.pause():e.isReadyToPlay&&e.play())}},Object(n.a)(T.a,{icon:(null===(s=t.current)||void 0===s?void 0:s.isPlaying)?I.s:I.v,sx:{fontSize:"50px",opacity:.8,"&:hover":{opacity:1}}}))),(null===(l=g.review)||void 0===l?void 0:l.disableCutting)||Object(n.a)(aa,{marker:"end",innerRef:j,value:b,control:d,invariant:(e,t)=>t<e,recordingDispatch:p,previewController:t,currentTime:e})),O("review-player-progress",{currentTime:e,duration:h})))},aa=({marker:e,value:t,control:a,invariant:i,currentTime:c,previewController:s,recordingDispatch:l,innerRef:d})=>{const{t:u}=Object(L.c)(),b={CUT_LEFT:e=>{e&&document.getElementById("leftmarker").click()},CUT_RIGHT:e=>{e&&document.getElementById("rightmarker").click()}},p=Object(n.a)(Z.GlobalHotKeys,{keyMap:de,handlers:b},Object(n.a)("div",{sx:{flex:1,textAlign:"start"===e?"right":"left",color:"gray.0"}},null!==t&&Object(n.a)(o.Fragment,null,Object(n.a)(L.a,{t:u,i18nKey:`review-${e}`},{[e]:t}," ",Object(n.a)(r.h,{href:"",onClick:e=>{e.preventDefault(),s.current.currentTime=t}})),Object(n.a)($e,{content:u("review-remove-cut-point")},Object(n.a)(r.g,{context:e,ref:d,onClick:()=>l({type:`UPDATE_${e.toUpperCase()}`,payload:null})},Object(n.a)(T.a,{icon:I.B})))))),g=(()=>{var e;return c<=.001||c>=(null===(e=s.current)||void 0===e?void 0:e.duration)||null!=a&&!i(c,a)})(),O=Object(n.a)(Z.GlobalHotKeys,{keyMap:de,handlers:b},Object(n.a)($e,{content:u(`review-set-${e}`)},Object(n.a)("button",{id:"start"===e?"leftmarker":"rightmarker",disabled:g,onClick:()=>{let t=s.current.currentTime;null==a||i(t,a)||(t=a),l({type:`UPDATE_${e.toUpperCase()}`,payload:t})},sx:{backgroundColor:"transparent",color:"text",border:"none",pt:"4px",px:"8px",borderRadius:"4px","&:disabled":{opacity:.3},"&:not(:disabled):hover":{backgroundColor:"gray.3"}}},Object(n.a)(Qt,{sx:{height:"32px",transform:"end"===e?"scaleX(-1)":""}}))));return"start"===e?Object(n.a)(o.Fragment,null,p,O):Object(n.a)(o.Fragment,null,O,p)},na=Object(o.forwardRef)((function({onTimeUpdate:e,onReady:t},a){var r;const{recordings:i,start:c,end:s}=D(),{t:l}=Object(L.c)(),d=[Object(o.useRef)(),Object(o.useRef)()],u=d.slice(0,i.length),b=2===i.length?"desktop"===i[0].deviceType?0:1:null,p=Object(o.useRef)();Object(o.useImperativeHandle)(a,(()=>({get currentTime(){return d[p.current||0].current.currentTime},set currentTime(e){u.forEach((t=>t.current.currentTime=e))},get duration(){var e;return null===(e=d[p.current||0].current)||void 0===e?void 0:e.duration},get isPlaying(){const e=d[p.current||0].current;return e&&e.currentTime>0&&!e.paused&&!e.ended},get isReadyToPlay(){return u.every((e=>e.current.readyState>=2))},play(){u.forEach((e=>e.current.play()))},pause(){u.forEach((e=>e.current.pause()))}})));const g=[Object(o.useRef)(),Object(o.useRef)()],[O,h]=Object(o.useState)(),m=e=>null!==c&&e<c||null!==s&&e>s,j=(null===(r=d[p.current||0].current)||void 0===r?void 0:r.currentTime)||0,v=m(j),[,x]=Object(o.useState)(v);Object(o.useEffect)((()=>{O&&t()}),[t,O]),Object(o.useEffect)((()=>{if(O&&2===i.length){d[b].current.volume=0;const e=d[0].current,t=d[1].current;let a,n=0;const r=()=>{if(n%60===0){if(Math.abs(e.currentTime-t.currentTime)>.15&&null!=p.current){const e=d[p.current].current;d[0===p.current?1:0].current.currentTime=e.currentTime}}n++,a=window.requestAnimationFrame(r)};return a=window.requestAnimationFrame(r),()=>window.cancelAnimationFrame(a)}}));const f={FORWARD_5_SEC:e=>{e&&y(e)},BACKWARDS_5_SEC:e=>{e&&y(e)},FORWARD_1_FRAME:e=>{e&&w(e)},BACKWARDS_1_FRAME:e=>{e&&w(e)}},y=e=>{d.forEach((t=>{void 0!==t.current&&("l"===e.key||"ArrowRight"===e.key?t.current.currentTime=Math.min(t.current.duration,t.current.currentTime+5):"j"!==e.key&&"ArrowLeft"!==e.key||(t.current.currentTime=Math.max(0,t.current.currentTime-5)))}))},w=e=>{d.forEach((t=>{void 0!==t.current&&("."===e.key?t.current.currentTime=Math.min(t.current.duration,t.current.currentTime+1/30):","===e.key&&(t.current.currentTime=Math.max(0,t.current.currentTime-1/30)))}))},k=i.map(((t,a)=>({body:Object(n.a)(Z.GlobalHotKeys,{keyMap:de,handlers:f},Object(n.a)("div",{sx:{position:"relative",width:"100%",height:"100%"}},v&&Object(n.a)("div",{sx:{position:"absolute",left:0,right:0,top:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.65)",color:"white",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",pointerEvents:"none"}},Object(n.a)(Bt,{sx:{height:"4em"}}),Object(n.a)("p",{sx:{my:3}},l("review-part-will-be-removed"))),Object(n.a)("video",{ref:d[a],key:a,src:t.url,onLoadedData:e=>{e.target.currentTime=Number.MAX_VALUE,g[a].current="started"},onTimeUpdate:O?t=>{const a=t.target.currentTime;x(m(a)),e(t)}:e=>{if(!O)switch(g[a].current){case"started":e.target.currentTime=.001,g[a].current="done";break;case"done":g.filter((e=>"done"===e.current)).length===i.length&&h(!0)}},preload:"auto",tabIndex:"-1",sx:{width:"100%",height:"100%",backgroundColor:"#ccc",outline:"none"}}))),dimensions:()=>t.dimensions})));return Object(n.a)(he,{gap:20},k)}));function ra({activeStep:e,updateActiveStep:t,userHasWebcam:a}){return Object(b.e)()?Object(n.a)(F,{activeStep:e,updateActiveStep:t},Object(n.a)(ut,{userHasWebcam:a}),Object(n.a)(ye,null),Object(n.a)($t,null),Object(n.a)(Jt,null),Object(n.a)(_e,null)):null}var oa=[{short:"en",long:"English",rtl:!1},{short:"de",long:"Deutsch",rtl:!1},{short:"nl",long:"Dutch",rtl:!1},{short:"el",long:"\u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ac",rtl:!1},{short:"es",long:"Espa\xf1ol",rtl:!1},{short:"fa",long:"Farsi",rtl:!0},{short:"fr",long:"Fran\xe7ais",rtl:!1},{short:"sl",long:"Sloven\u0161\u010dina",rtl:!1},{short:"tr",long:"Turkish",rtl:!1},{short:"zh",long:"\u7b80\u4f53\u4e2d\u6587",rtl:!1}];const ia=({title:e,children:t})=>Object(n.a)(r.a,{sx:{"&:not(:last-child)":{mb:5}}},Object(n.a)(A.b.h2,{sx:{borderBottom:e=>`1px solid ${e.colors.gray[2]}`,pb:1,my:3,mx:0}},e),t);var ca=()=>{const{i18n:e,t:t}=Object(L.c)();var a=t("settings-language-label");return"Language"!==a&&(a+=" / Language"),Object(n.a)(ia,{title:t("settings-general-header")},Object(n.a)("label",{htmlFor:"studio-lang",sx:{variant:"styles.label"}},a),Object(n.a)("select",{id:"studio-lang",sx:{variant:"styles.select"},defaultValue:e.language,onChange:t=>e.changeLanguage(t.target.value)},oa.map((e=>Object(n.a)("option",{value:e.short,key:e.short},e.long)))))};var sa=function({settingsManager:e}){const t=Object(s.h)(),{t:a}=Object(L.c)(),i=Object(Ce.n)(),[l,d]=Object(o.useState)(),{errors:u,handleSubmit:b,register:p}=Object(Ee.a)({defaultValues:e.formValues().opencast}),[g,O]=Object(o.useState)("initial"),{recordings:h}=D(),m=h.length>0;async function j(t){O("testing");const n=await Ce.a.init({...e.settings().opencast,...t});switch(n.getState()){case Ce.f:i.setGlobalInstance(n),e.saveSettings({opencast:t}),O("saved"),d(null);break;case Ce.g:O("error"),d(a("upload-settings-error-server-unreachable"));break;case Ce.h:O("error"),d(a("upload-settings-error-response-not-ok"));break;case Ce.e:O("error"),d(a("upload-settings-error-invalid-response"));break;case Ce.d:O("error"),i.isLoginProvided()?d(a("upload-settings-invalid-provided-login")):d(a("upload-settings-invalid-login-data"));break;case Ce.c:case Ce.i:default:console.error("bug: invalid state reached..."),O("error"),d("internal error :(")}}const v=e.isConfigurable("opencast.serverUrl"),x=e.isUsernameConfigurable(),f=e.isPasswordConfigurable();if(!v&&!x&&!f)return null;const y={testing:I.h,error:I.l,saved:I.f}[g],w={NEXT_BUTTON:e=>{e&&b(j(e))}};return Object(n.a)(Z.GlobalHotKeys,{keyMap:ue,handlers:w},Object(n.a)(ia,{title:a("upload-settings-modal-header")},Object(n.a)(r.a,null,l&&Object(n.a)(me,{isDanger:!0},l),Object(n.a)("form",{onSubmit:b(j)},v&&Object(n.a)(De,{errors:u,label:a("upload-settings-label-server-url"),name:"serverUrl",register:p,validate:e=>{try{const t=new URL(e);return"https:"===t.protocol||"http:"===t.protocol||a("upload-settings-invalid-url-http-start")}catch(t){let n=a("upload-settings-invalid-url");return e.startsWith("https://")||e.startsWith("http://")||(n+=" "+a("upload-settings-invalid-url-http-start")),n}},required:!0}),x&&Object(n.a)(De,{errors:u,label:a("upload-settings-label-username"),name:"loginName",register:p,required:!0}),f&&Object(n.a)(De,{errors:u,label:a("upload-settings-label-password"),name:"loginPassword",register:p,required:!0,type:"password"}),Object(n.a)("footer",{sx:{mt:4}},Object(n.a)(r.b,{sx:{verticalAlign:"middle"}},a("upload-settings-button-store")),y&&Object(n.a)(T.a,{icon:y,sx:{ml:"10px",fontSize:"30px",verticalAlign:"middle"},spin:"testing"===g}),m&&"saved"===g&&Object(n.a)(c.b,{to:{pathname:"/",search:t.search},sx:{ml:3,variant:"styles.a"}},a("settings-back-to-recording")))))))};var la=()=>{const{t:e}=Object(L.c)(),[,t]=Object(P.b)(),a=()=>{window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):t("light")};Object(o.useEffect)((()=>{"systemTheme"===localStorage.getItem("theme")&&a()}));const r=[{value:"systemTheme",label:e("settings-theme-system")},{value:"lightTheme",label:e("settings-theme-light")},{value:"darkTheme",label:e("settings-theme-dark")}];return Object(n.a)(ia,{title:e("settings-theme-appearance")},Object(n.a)("select",{sx:{variant:"styles.select"},defaultValue:localStorage.getItem("theme"),onChange:e=>{return n=e.target.value,localStorage.removeItem("prefers-color-scheme"),void("systemTheme"===n?(a(),localStorage.setItem("theme","systemTheme")):"darkTheme"===n?(t("dark"),localStorage.setItem("theme","darkTheme")):(t("light"),localStorage.setItem("theme","lightTheme")));var n}},r.map(((e,t)=>Object(n.a)("option",{key:t,value:e.value},e.label)))))};var da=({settingsManager:e})=>{const{t:t}=Object(L.c)();return Object(n.a)(r.a,{sx:{width:"100%",maxWidth:960,mx:"auto",p:3}},Object(n.a)("header",null,Object(n.a)(A.b.h1,{sx:{mb:"1.5em"}},t("settings-header"))),Object(n.a)(la,null),Object(n.a)(ca,null),Object(n.a)(sa,{settingsManager:e}))};var ua=()=>{const{t:e}=Object(L.c)();let t=[];return"https:"!==window.location.protocol&&"localhost"!==window.location.hostname&&"127.0.0.1"!==window.location.hostname&&t.push(Object(n.a)(me,{key:"unsecure-connection",isDanger:!0},e("warning-https"))),Object(b.e)()||t.push(Object(n.a)(me,{key:"media-recorder",isDanger:!0},e("warning-recorder-not-supported"),Object(b.h)()&&" "+e("warning-recorder-safari-hint"))),t.length>0?Object(n.a)("div",{sx:{p:3}},t):null};const ba=({name:e,entries:t})=>{const{t:a}=Object(L.c)();return Object(n.a)("div",{sx:{margin:"10px",display:"flex",flexDirection:"column","@media screen and (max-width: 350px)":{width:"300px"}}},Object(n.a)("h3",{sx:{borderBottom:e=>`1px solid ${e.colors.gray[1]}`,textAlign:"center"}},a(e)),t.map(((e,t)=>Object(n.a)(pa,{params:e,key:t}))))},pa=({params:e})=>{const{t:t}=Object(L.c)();return Object(n.a)("div",{sx:{display:"flex",flexDirection:"row",padding:"6px 0",alignItems:"center"}},Object(n.a)("div",{sx:{width:"40%",wordWrap:"break-word"}},t(e.name)),e.description.map(((e,a,r)=>Object(n.a)("div",{key:a,sx:{padding:"2px 0",display:"flex"}},e.toString().split("+").map(((e,a)=>Object(n.a)("div",{key:a,sx:{borderRadius:"5px",border:e=>`2px solid ${e.colors.singleKey_border}`,background:e=>e.colors.singleKey_bg,padding:"8px",margin:"0 3px",textAlign:"center",minWidth:"40px"}},t(e)))),Object(n.a)("div",{sx:{alignSelf:"center",lineHeight:"32px",margin:"0 5px"}},r.length-1!==a&&t("sequence-seperator"))))))};var ga=()=>{const{t:e}=Object(L.c)(),t=Object.fromEntries([le,de,ue].flatMap(Object.entries));let a={};if(t&&Object.keys(t).length>0)for(const n of Object.values(t)){var r;const t=null!==(r=n.group)&&void 0!==r?r:e("other-shortcuts");t in a||(a[t]=[]),a[t].push(n)}const o=Object.entries(a).filter((([e,t])=>t.length>0)).map((([e,t])=>Object(n.a)(ba,{name:e,key:e,entries:t})));return Object(n.a)("div",{sx:{display:"flex",flexDirection:"column",alignItems:"center",alignSelf:"center",width:"100%"}},Object(n.a)("h2",{sx:{display:"block",position:"relative",textAlign:"center"}},e("nav-shortcuts")),Object(n.a)("div",{sx:{display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center"}},o))};const Oa=({settingsManager:e,userHasWebcam:t})=>{const[a,r]=Object(o.useState)(0),i=Object(s.h)();return Object(n.a)(o.Fragment,null,Object(n.a)(ha,null),Object(n.a)(s.d,null,Object(n.a)(s.b,{path:"/settings",exact:!0},Object(n.a)(da,{settingsManager:e})),Object(n.a)(s.b,{path:"/shortcuts",exact:!0},Object(n.a)(ga,null)),Object(n.a)(s.b,{path:"/about",exact:!0},Object(n.a)(U,null)),Object(n.a)(s.b,{path:"/",exact:!0},Object(n.a)(ra,{activeStep:a,updateActiveStep:r,userHasWebcam:t})),Object(n.a)(s.b,{path:"/*"},Object(n.a)(s.a,{to:{pathname:"/",search:i.search}}))))},ha=()=>{const{recordings:e,upload:t}=D(),a=e.every((e=>e.downloaded)),r=t.state===f,o=t.state===x;return Object(n.a)(l.a,{onBeforeunload:t=>{((null===e||void 0===e?void 0:e.length)>0&&!r&&!a||o)&&t.preventDefault()}})};t.default=function({settingsManager:e,userHasWebcam:t}){var a;const o=Object(u.e)();return Object(n.a)(c.a,{basename:"/"},Object(n.a)(d.a,{styles:(null===(a=o.theme)||void 0===a?void 0:a.customCSS)||""}),Object(n.a)(R,null,Object(n.a)(r.e,{sx:{flexDirection:"column",height:"100%"}},Object(n.a)(H,null),Object(n.a)("main",{sx:{flex:1,display:"flex",flexDirection:"column",minHeight:"285px"}},Object(n.a)(ua,null),Object(n.a)(Oa,{settingsManager:e,userHasWebcam:t})))))}}}]);
//# sourceMappingURL=4.ce8b019a.chunk.js.map